
--- Custom IOAs ---

â€¢ What are IOAs?
â€¢ IOA Workflow
â€¢ Different options based on OS 
â€¢ Review of Regex and CS Gotchas
â€¢ IOC Management
â€¢ Icons


-- What are IOAs? --

â€¢ Indicators of Attack (IOA)
â€¢ Custom IOCs to implement into CS via regex pattern matching
â€¢ Actions: Monitor, Detect, Block Execution, Kill Process (depends on what Rule Type you select)
â€¢ Rule Types: Process Creation, File Creation, Network Connection, Domain Name

Path: Endpoint security > Configure > Custom IOA Rule Groups


-- IOA Workflow --

â€¢ Create a rule group
â€¢ Add your IOAs to the rule group
â€¢ Enable your rules
â€¢ Enable your IOA rule group
â€¢ Assign Group to a Prevention Policy


-- Different options based on OS --

Rule Types: Process Creation, File Creation, Network Connection, Domain Name

| Rule Option        | Windows  | MacOS | Linux |
|--------------------|----------|-------|-------|
| Process Creation   |    âœ”    |   âœ”   |   âœ”   |
| File Creation      |    âœ”    |   âœ”   |   âœ”   |
| Network Connection |    âœ”    |   âœ”   |       |
| Domain Name        |    âœ”    |       |        |
|--------------------|----------|-------|-------|


-- Review of Regex and CS Gotchas --

1. .* still works for wildcards
2. Need to escape \ just like usual
3. Leave all unused fields as .*
4. Always TEST the rule before implementing. Just because test pattern is correct doesnâ€™t mean itâ€™s the right regex for the job!

What we can do with IOAs:

1. Block CIDR ranges of IPs
2. Blocking IPs
3. Blocking Domains
4. File names
5. File paths
6. Parent, Grandparent file names
7. Command Line Arguments, parent command lines


-- IOC Management --

â€¢ Keep in mind, these are all sensor-based actions
â€¢ Can assign a severity to the detection (color codes can be set in preferences)
â€¢ Can put to a specific host group, or all hosts
â€¢ Can add tags into the IOC being implemented (â€œBad IPâ€, â€œAdwareâ€, â€œIT Toolâ€)

| Type    | Block | Block+Hide | Allow | Detect Only | Do Nothing |
|---------|-------|------------|-------|-------------|------------|
| Domains |       |            |       |      âœ”     |     âœ”      |
| Hashes  |   âœ”   |     âœ”     |   âœ”   |      âœ”     |     âœ”      |
| IPs     |       |            |       |      âœ”     |     âœ”      |
|---------|-------|------------|-------|-------------|------------|


-- Icons --

â€¢ ğŸŸ¥ Red cube â†’ Part of an Incident  
â€¢ ğŸŸ¥ Red cube + âœ… shield â†’ Process was blocked  
â€¢ ğŸŸ¥ Red cube + â­• shield â†’ Process was killed or operation was blocked  
â€¢ ğŸŸ¥ Red cube + ğŸ›¡ï¸ black â†’ Overwatch Detection  
â€¢ ğŸ”µ ğŸŸ¡ ğŸŸ  ğŸ”´ ğŸŸ£ â†’ Severity scale (Low to Critical)  




















