
--- CrowdStrike Falcon Detection Investigation & RTR Runbook ---

‚Ä¢ Identify the Detection
‚Ä¢ Analyze the Detection
‚Ä¢ Real-Time Response (RTR) Deep Dive
‚Ä¢ Host Context Investigation
‚Ä¢ Network Operations
‚Ä¢ Event Search (Falcon Insight)
‚Ä¢ Explore Detection
‚Ä¢ Final Actions & Documentation
‚Ä¢ Splunk & PowerShell Enrichment


This is now a full CrowdStrike Falcon IR Playbook with:
‚Ä¢ Detection template
‚Ä¢ OSINT resources
‚Ä¢ RTR commands & workflow
‚Ä¢ Blocking/Exclusions
‚Ä¢ Sandbox handling
‚Ä¢ Splunk & PowerShell enrichment



1. Identify the Detection
‚Ä¢ Falcon Console ‚Üí Detections ‚Üí Filter: Critical/High
‚Ä¢ Click into Full Detection Details

2. Analyze the Detection

a. Process Activity
‚Ä¢ Review process tree
‚Ä¢ Focus on parent/child relationships, LOLBins (PowerShell, wmic, rundll32), unusual parent-child combos

b. File Analysis
‚Ä¢ Dropped, modified, executed files
‚Ä¢ Validate SHA256 in VirusTotal + internal DB

c. Executable Locations
‚Ä¢ Suspicious if found in %TEMP%, %APPDATA%, C:\ProgramData, C:\Users\Public\
‚Ä¢ Look for .exe, .dll, .bat, .vbs, .js

d. Quarantine Files
‚Ä¢ In console: quarantine file
‚Ä¢ Via RTR:

get /path/to/file
quarantine /path/to/file

3. Real-Time Response (RTR) Deep Dive

a. Device Type: hostname, systeminfo
b. Severity & Context: Host role, user role, exposure
c. Time Correlation: time
d. Network & DNS: netstat -ano, ipconfig /displaydns
e. File/Path Inspection: ls C:\Users\[user]\AppData\Roaming, ls C:\ProgramData, sha256sum C:\path\to\suspicious.exe
f. Process Inspection: ps, cat C:\path\to\script.ps1
g. Quarantine (again): get C:\path\to\suspicious.exe, quarantine C:\path\to\suspicious.exe
h. Kill Process: kill [PID]

4. Host Context Investigation: whoami, query user
‚Ä¢ Check logged-in user, admin rights
‚Ä¢ Console ‚Üí Host Management: software, users, processes

5. Network Operations
‚Ä¢ DNS/Beaconing (rare domains, beacon-like traffic)
‚Ä¢ IP reputation checks: CrowdStrike Intel, WHOIS, VirusTotal, AbuseIPDB

6. Event Search (Falcon Insight)

Example query:

event_platform = "WinEvent"
| filter event_simpleName = "ProcessRollup2"
| filter TargetProcessName = "*suspicious.exe"

7. Explore Detection
‚Ä¢ Check detection method: Behavioral / IOA / ML
‚Ä¢ Map to MITRE ATT&CK techniques
‚Ä¢ Tag detection:
  ‚Üí ‚úÖ True Positive
  ‚Üí ‚ùå False Positive
  ‚Üí üîç Under Investigation

8. Final Actions & Documentation: contain
‚Ä¢ Collect evidence: memory dumps, suspicious files
‚Ä¢ Document: Root cause, MITRE TTPs, remediation, assignment


-- Splunk & PowerShell Enrichment --

Splunk ‚Äì Time Analysis by Hash


SHA256HashData="92804faaab2175dc501d73e814663058c78c0a042675a8937266357bcbf96c50"
| stats min(_time) as Start, max(_time) as End count by ComputerName UserName FilePath FileName
| convert ctime(Start), ctime(End)


Splunk ‚Äì Full Activity Table

| table _time ComputerName event_simpleName UserName SHA256HashData FileName CommandLine DomainName LocalIP LPort RemoteIP RPort


PowerShell ‚Äì Search across drive

Get-ChildItem C:\* -Recurse | Select-String -Pattern "malware" | Select-Object -First 1














