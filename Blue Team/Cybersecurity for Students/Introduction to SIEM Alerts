
-- Introduction to SIEM Alerts --

• Detection 
• Case Creation and Playbook Initiation 
• Email Analysis 
• Network and Log Analysis 
• Endpoint Analysis 
• Containment
• Result 


- Introduction to SIEM Alerts -

LetsDefend's Practice page provides hands-on exercises and simulations to deepen the understanding of the SIEM alert investigation process in a simulated Security Operations Centre (SOC) environment. This course will introduce you to the fundamentals of alert analysis and how to get the most out of the exercises and simulations.

What Will You Learn
The more alerts you close, the faster you can respond to new attacks and handle the hundreds of alerts that come through any security operations center, as these alerts cover many of the techniques used by real threat actors.
Improved Analysis Skills: Enhance your alert analysis abilities by utilizing advanced techniques, allowing for more precise identification of potential threats and anomalies.

• Tool Familiarity: Gain hands-on experience with common cybersecurity tools used in SOCs.
• Log Analysis: Gain valuable insight into how to locate logs and detect malicious activity to effectively identify and respond to security threats.
• Improved Incident Response: Enhance your ability to swiftly and effectively respond to security incidents, minimizing potential damage and reducing downtime.
• Enhanced Threat Intelligence: Gain valuable insight into evolving threats and attack techniques by analyzing and resolving alerts, empowering proactive defense strategies.
• Continuous Improvement: Stay on top of emerging threats and solve alerts to improve your preparedness and response capabilities.


- Detection -

SIEM alerts are notifications generated by the SIEM system based on predefined rules and correlation algorithms. These rules are typically customized to meet an organization's specific security requirements. When an event matches the defined criteria, the SIEM system triggers an alert.
In LetsDefend, alerts are prepared and continuously updated by cybersecurity experts. These alerts cover a range of threats, from the most common attacks used by adversaries to the most sophisticated zero-day exploits. 

Monitoring
This section introduces you to the "Monitoring" page. Divided into three sections, the Monitoring page acts as a dashboard for viewing generated alerts. These sections are:

• Main Channel
• Investigation Channel
• Closed Alerts

Main Channel
The default view of the Monitoring page displays all open incidents available for ownership. Within the Main Channel, you'll find fields displaying key details about the triggered alerts, including:

• Severity : Indicates the level of severity, categorized as Low , Medium , High , or Critical .
• Date : Displays the date of the incident. (UTC +0 Timezone)
• Rule Name : Identifies the specific rule triggered by the event.
• EventID : Provides a unique identifier for the event.
• Type : Specifies the type of event or alert triggered.
• Action : Assigns ownership of the alert to you for further investigation and analysis.

 You can refine the alerts displayed based on Severity, Type, and Role criteria using the Filter button in the top left corner. 

Taking Ownership
Once you have decided which alert you want to investigate, click on it to access further details. The alert details provide comprehensive insight into various aspects of the alert. Next, use the 'Take ownership' option in the top right-hand corner. This action will assign the alert to you for further analysis and investigation. 
Upon taking ownership of the alert, it is automatically sent to the investigation channel, where you can initiate the case to further analyze and respond to the security incident. 

Investigation Channel
The Investigation Channel is designed for managing and responding to active alerts. When an alert is assigned to you, it will appear in this channel. From here, you can create a case to investigate the alert in more detail. 
When you create a case for an alert, the 'Case Management' page opens immediately, allowing you to start the playbook. From the Case Management page, you can view the details of the incident and start the Playbook, which is a pre-arranged series of instructions that guide you through the processes of the investigation. 

Playbooks
There are many different types of alerts (web attacks, ransomware, malware, phishing, etc.) in the SOC (Security Operations Centre) environment. The methods and approaches for investigating these alerts are different. Workflows for effective and consistent analysis of alerts generated by SIEM or other security tools are called playbooks.
For example, when you click the 'Create Case' button for an alert on the LetsDefend monitoring page, a ticket is automatically created in the 'Case Management'. The system will assign a specific playbook to it and provide you with the necessary steps to properly investigate the alert by following the instructions. 

Why Are Playbooks Important?
As SOC analysts, we don't always know the exact steps to take when dealing with alerts. Playbooks help by providing a clear, step-by-step process to follow during an investigation. This is especially helpful for new analysts just starting their SOC careers. 

Closing the Alert
Once the playbook has been completed and all inquiries have been dealt with, including the analysis phase, we need to return to the Monitoring page within the Investigation channel to officially close the alert.
The alert needs to be analyzed to determine if it is a true positive or a false positive. A true positive means that the alert is legitimate and requires further action, whereas a false positive means that the alert is a false alarm. 
Once you've completed your analysis, you should document your findings in the Analyst Note section. The document should include your reasoning, relevant data or observations, and steps taken during your investigation. It is critical as it provides a record of your analysis and can be used for future reference or in resolving similar alerts.
Once the alert is closed, you can review the details of your analysis in the Closed Alerts section. Here you'll find the answers you provided to the Playbook questions, confirming your accurate assessment of the situation. 
For further insight into the investigation process and additional context around the alert, you can also access the official incident report or community walkthrough. These resources offer valuable information for understanding the threat landscape and improving future response efforts. 


- Case Creation and Playbook Initiation -

Creating a case allows us to organize and track our investigation efforts, while the playbook guides us through the necessary steps to effectively respond to the security incident. 

Take Ownership
In this course, we will analyze the EventID: 257 - SOC282 - Phishing Alert - Deceptive Mail Detected . This is a phishing alert that requires an investigation to determine its legitimacy and potential impact. First, to assign the alert to yourself, click the button below. 

Creating a Case
When an alert requires further investigation, the first step is to create a case. This involves documenting the details of the alert, assigning ownership, and initiating the playbook.  You can see alerts assigned to you in the Investigation Channel.

1. Create a case:
• Navigate to the Investigation Channel.
• Select the alert for which you want to create a case.
• Click the "Create a Case" button to initiate the case creation process.

Launch the Playbook
Once the case has been created, you will be taken to the Case Management tab. On this page, you will find 'Incident Details'. The playbook provides pre-defined instructions to guide your investigation, and following these steps will assist you in analyzing the case.

Start the Playbook: Press the “Start Playbook” button. 

The first step of the playbook, 'Parse Email', instructs us to gather key details about the received email, including information such as sender, recipient, time, and any suspicious content or attachments. 

Keep the Playbook Tab Open
• The playbook tab should be kept open on the side at all times.
• Keep the playbook tab open, create a new tab, and go back to the Alert Investigations tab.

You can find answers to some of the questions on the Alert Details page. Please open a new text file and make a note of your findings.
• Click on the Monitoring Page
• Head to the Investigation Channel
• Review the Alert Details.


- Email Analysis -

Analyze emails to gather information relevant to our investigation, as emails are often a key source of evidence and provide valuable insight into potential security threats.

Navigating to Email Security
To begin the email analysis, navigate to the Email Security tab. This section provides tools and features for examining emails in detail. 

Using Detailed Search
Use the detailed search bar in the Email Security tab to find the specific email related to the investigation. Fill in the following fields as needed:
• Sender
• Recipient
• Subject
• Sender IP Address
• Attachment Name
• Email Body
• Date
• Action

Examining Email Content
Once you've found the email examine it to find the answers to the last two questions in the first step of the playbook.
• Is the content of the email suspicious?
• Are there any attachments?

Steps to follow :
• Click on the email to see its content.
• Review the email body, attachments, sender information, and other details.
• Scroll down to view any attachments.

Continue the Playbook
Once you have gathered the information you need, make a note of it to complete this step. 

Next Step of the Playbook
The next step instructs us to check for attachments or URLs in the email. 

To determine this :
• Look for attachments: Look at the bottom of the email to see if there are any attached files.
• Review the body of the email: Check the text to see if it contains any hyperlinks. Hyperlinks can lead to malicious websites or downloads, so it’s important to identify and analyze them.

Analyze URLs/Attachments
The next step of the playbook is about analyzing URLs/Attachments. If the email contains any attachments or URLs, it is crucial to analyze them using third-party sandboxes. These sandboxes allow us to safely check if the content is malicious without putting our systems at risk. 

Note : It is recommended to use a virtual machine to download the attachments or files provided by alerts, as they may contain malware. You can use a sandbox for this purpose. The password for the zip files is always " infected " unless stated otherwise.

Follow these steps:
• Download Attachment/s: Download the email attachment.
• Analyze URLs/Attachments: Use the provided tools to check the safety of attachments and URLs.

You can use the following free products/services:
AnyRun : An interactive malware analysis service, sandbox. (https://app.any.run/)
VirusTotal : A service that analyzes files and URLs for viruses. (https://www.virustotal.com/gui/home/upload)
URLHouse : A database of malicious URLs. (https://urlhaus.abuse.ch/)
URLScan : A tool for scanning and analyzing websites. (https://urlscan.io/)
HybridAnalysis : A free malware analysis service. (https://www.hybrid-analysis.com/)

If the content is malicious:
• Click "Malicious" to indicate that the content poses a threat.

If the content is not malicious:
• Click "Non-malicious" to indicate that the content is safe.

Alternatively, you can use sandbox machines in LetsDefend for static analysis. These machines contain various malware analysis tools and are safe to use.
Sandbox : “ https://app.letsdefend.io/sandbox ” 

Next Step of the Playbook
In the next step of the playbook, we need to find out if the email has been delivered to the user. To understand the reach and potential impact of the suspicious email, this step is critical. 

Check if the mail was delivered to the user:
To determine this, we need to examine the 'Device Action' part of the alert details, as this section provides information about the actions taken by the security system regarding the email.

Steps to follow:
Navigate to Alert Details
• Go back to the Alert Details page in the Investigation Channel.

Check the "Device Action" Section
• Find the part of the alert that details the actions taken by the security system.

Determine the Email Delivery status
• Look for entries that indicate whether the email was delivered or not. Common terms you might see include " Allowed ", " Deleted " or " Quarantined ".

Answer the Playbook Question
• Based on the information found in the "device action" section, determine if the email was delivered to the user.
• If the email was delivered, select " Delivered ".
• If the email was not delivered, select " Not Delivered ".

As you can see in the screenshot above, the Device Action section shows the action taken on the email. So if it is 'allowed', it means that the email reached the user. If it is 'Blocked' or 'Quarantined', it means that the email was intercepted and did not reach the user. 

Continue the Playbook
After determining the email's delivery status, document your findings and continue to the next playbook step. 

Playbook Step 5
This step is crucial "to prevent any damage that could be caused by the e-mail if it were to be accessed by the user. 

Delete the Email from the Recipient
To remove the malicious email from the recipient’s mailbox, follow these instructions:

Navigate to the Email Security tab:
• Return to the Email Security tab where you previously found the email.

Locate the Suspicious Mail:
• Use the search functionality to find the specific email that has been identified as malicious.

Delete the Email:
• Click on the email to open its detailed view.
• Delete the email by clicking the 'Delete' button at the top right of the Email Security panel.


- Network and Log Analysis -

Focuses on analyzing network and log data to determine whether malicious URLs were accessed. To determine if the user has executed the file they have downloaded, this step is critical. 

Navigating Log Management
To begin our analysis, navigate to the “Log Management” page. Here, we will review logs to identify any suspicious activity or connections to malicious IP addresses and command and control (C2) addresses. 

Find the IP Address of the Affected Host
• Go to the “Endpoint Security” page on the LetsDefend platform. Search for the hostname on the search bar.
• Review “Host Information” and find the IP address of the host computer.

Navigate to the Log Management Page:
• Navigate to the "Log Management" page on the LetsDefend platform. Switch to "Basic" mode by clicking the button in the top right hand corner of the screen.

Search for the IP Addresses:
• In the search bar, enter the IP address of the hostname in question. This will allow you to see all connections made from that host.

Analyze Log Entries:
• Examine the log entries displayed. Focus on the "SRC ADDRESS" and "DEST ADDRESS" columns to identify any suspicious connections.
• Review network actions to identify any unusual outbound connections or data transfers within the alert's time frame that may suggest communication with a C2 server.

Determine Access Status:
• Click the Raw Data button to view the raw log of the specified entry. Determine whether the malicious file or URL was accessed.

The example above demonstrates the importance of carefully reviewing log data to identify any signs of malicious activity. Accurate log analysis is essential to understanding the scope of the incident and taking appropriate action.

Threat Intel
LetsDefend provides a Threat Intel tab to analyze Indicators of Compromise (IOCs). This tab aggregates data from various threat intelligence sources to identify malicious IP addresses, domains, or URLs. Here you can search for the IOCs you've found during your investigation. 

Here's how to utilize the Threat Intel tab:

Navigate to the Threat Intel Tab:
• Head to the Threat Intel tab on the LetsDefend platform. This tab consolidates threat intelligence data for easy access during investigations.

Search for the IOC:
• In the search bar on the Threat Intel tab, type the suspicious IP address or URL you found in Log Management. LetsDefend will query its threat intelligence database to determine if the IOC is associated with any known malicious activity.

Review the Results:
• Review the results of the threat intelligence query. LetsDefend will provide information on whether the IOC has been flagged as malicious or if it has a history of involvement in cyber threats.

Note down the findings
Once you have completed the log analysis, record your findings and note the IOC found. 


- Endpoint Analysis -

Endpoint Security analysis involves examining the processes and browser activity on the affected endpoints to identify any further indicators of compromise.
Endpoint security operates as an Endpoint Detection and Response (EDR) system, collecting log data and providing insight into activity on the host machine. Like EDRs such as Carbon Black, SentinelOne, CrowdStrike, and most others EDRs, LetsDefend Endpoint Security allows you to connect to machines, collect detailed logs, and even isolate compromised machines.
This approach will allow us to verify whether the malware was executed on the system and identify the processes or commands it executed.

Navigating to Endpoint Security
To begin the analysis, navigate to Endpoint Security. This section provides comprehensive details about the host machine, including its processes, network actions, terminal history, and browser history. 

Select the Host:
• Find the host by typing its IP address or hostname in the search bar.

Review Endpoint Information:
• Examine the host information displayed, including the hostname, IP address, operating system, and last login details.

Process and Network Action Analysis
Process and network action analysis aims to detect suspicious processes and identify communication with command and control addresses. 

Analyze Processes:
• Check the list of running processes. Look for any unfamiliar or suspicious processes that could indicate malicious activity.
• Dive deeper into the details of any identified suspicious processes.
• Broaden your investigation to include related processes, examining both parent and child processes to uncover hidden links.
• Analyze the suspicious process HASH on Threat Intel platforms.

Network Actions:
• Check network activity during the alert's time frame.
• Note any unusual inbound or outbound connections that may indicate communication with a C2 server.
• Cross-reference these indicators of compromise (IOCs) on threat intel platforms.

Terminal and Browser History Analysis
As a part of the analysis, we must examine terminal history to see if any commands were typed into the computer that seems suspicious or unusual, as this could be a sign that someone was trying to do something they shouldn't.
Similarly, when we examine the browser history, we're looking for any visits to websites that are known to be malicious, or any links that may have been clicked on to download dangerous files.

Terminal and Browser History:
• Check the terminal history to identify suspicious commands executed on the host.
• Examine the browser history to identify any visits to malicious websites or download links.


- Containment -

Quickly implementing containment measures is vital in preventing further damage to the system.

Why is Containment Necessary?
• Prevent data loss
• Prevent Unauthorized access
• Prevent lateral movement
• Prevent data extortion


- Result  -

This chapter discusses the final alert response steps after completing the playbook and addressing all queries, including the analysis phase. Properly closing an alert is critical to determining whether the alert is true or false positive, documenting the findings, and reviewing the incident response process.

Closing The Alert
Once the playbook has been completed and all queries have been addressed, including the analysis phase, we must return to the Monitoring page within the Investigation channel to officially close the alert. 
The alert needs to be analyzed to determine if it is a true positive or a false positive. A true positive means the alert is legitimate and requires further action, whereas a false positive means that the alert is a false alarm. 
Once you’ve completed your analysis, you should document your findings in the “Analyst Note” section. This note should include the reasoning behind your decision, any relevant data or observations, and the steps taken during your investigation. 

Answers and the Official Incident Report
After closing the alert, you can review the details of your analysis in the "Closed Alerts" section. Here, you'll find the answers you provided to the playbook questions, confirming your accurate assessment of the situation. 

Official Incident Report
You can also access the official incident report or the community walkthrough. These resources provide further insight into the investigation process and additional context around the alert, offering valuable information to understand the threat landscape and improve future response efforts. The official incident report is a comprehensive summary of the incident. 
































