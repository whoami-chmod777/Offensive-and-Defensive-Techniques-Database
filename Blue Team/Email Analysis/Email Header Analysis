
An Email Header is a hidden section containing detailed information about the email's origin, routing, and delivery, accessible through email client settings.
The header contains several fields, each providing specific pieces of information. Here are the key components of an email header:

• From: The email address and optionally the name of the sender.
• To: The recipient's email address.
• Subject: The subject line of the email.
• Date: The date and time the email was sent.
• Return-Path: The email address that should receive bounce messages if the email can't be delivered.
• Received: Information about the servers that handled the email as it traveled from the sender to the recipient. Each server adds its own "Received" line, making it possible to trace the email's path.
• Message-ID: A unique identifier for the email, generated by the sending server.
• Content-Type: Specifies the format of the email (e.g., text/plain, text/html, multipart).
• MIME-Version: Indicates the version of the MIME protocol used.
• DKIM-Signature: Digital signature added by the sending server to verify the email's authenticity and integrity.
• SPF: Sender Policy Framework record, used to verify that the email was sent from an authorized server.
• DMARC: Domain-based Message Authentication, Reporting, and Conformance policy that uses SPF and DKIM to determine the legitimacy of an email.
• ARC-Seal, ARC-Message-Signature, ARC-Authentication-Results: Authenticated Received Chain (ARC) headers used to verify email authentication and preserve results across trusted intermediaries.
• X-Spam Status: The X-Spam Status shows you the spam score of an email message.



-- Using dig for SPF Verification --

dig (Domain Information Groper) is a command-line tool used for querying DNS (Domain Name System) servers. 

$ dig @8.8.8.8 -t txt example.com
$ dig @8.8.8.8 -t txt spf.protection.outlook.com
$ dig txt futurepipe.com | grep "v=spf1"



-- Extract Data --

sudo apt cache search lha
sudo apt install lhasa

cat file1.bin | base64 -d | xxd | less
cat file1.bin | base64 -d > file1.lzh
lhasa file1.lzh
ls




E-Mail Header Analyzer (MHA)
https://github.com/cyberdefenders/email-header-analyzer

Analyze Email Headers to understand routing, identify issues, and detect potential spam or malicious emails
https://mha.azurewebsites.net/

GitHub Repositorie that contain collections of spam and phishing emails
https://github.com/rf-peixoto/phishing_pot
