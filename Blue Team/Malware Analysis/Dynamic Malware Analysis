
Dynamic Malware Analysis is the process of running potentially malicious software in an isolated environment to monitor and analyze its actions and effects on the system.

Key Aspects to Monitor:

• File System Activity: Creation, modification, or deletion of files.
• Process Activity: New processes spawned, process injection, or unusual process behavior.
• Registry Changes: Modifications to registry keys and values.
• Network Traffic: Outgoing connections, data exfiltration, or communication with suspicious IP addresses or domains.
• Memory Activity: Unusual memory usage or memory injection techniques.
• Persistence Mechanisms: Attempts to achieve persistence through startup entries, scheduled tasks, or services.
• API Calls: Suspicious or uncommon API calls that might indicate malicious intent.
• System Changes: Changes to system settings, configurations, or security policies.
• Behavioral Anomalies: Any behavior that deviates from the norm, such as unexpected encryption or obfuscation.


Tools for Dynamic Malware Analysis:

Sandbox Environments
• Cuckoo Sandbox
• FireEye Dynamic Threat Intelligence (DTI)
• ThreatTrack ThreatAnalyzer (formerly GFI Sandbox)
• Joe Sandbox
• Hybrid Analysis
• Any.Run
• Malwr
• VxStream Sandbox
• CAPE (Config and Payload Extraction)

Process and System Monitoring
• Process Monitor (ProcMon)
• Process Hacker
• Autoruns
• Noriben
• Sysinternals Suite

Network Analysis
• Fiddler
• Wireshark
• TCPView
• ApateDNS
• FakeNet-NG

Static and Hybrid Analysis
• VirusTotal
• ReversingLabs TitaniumCloud
• Intezer Analyze
• Ghidra

Registry and System Change Detection
• Regshot

Debugging and Code Analysis
• OllyDbg
• x64dbg
• PE-sieve
• Windbg
• Radare2

Visual Analysis and Correlation
• ProcDot

Specialized Linux Toolkit
• REMnux

Other Tools
• SysInternal Tools
• CFF Explorer
• PEView
• TriDNet
• BinText
• PEiD
• Regshot
• HashMyFiles


Detailed Focus Areas:

Process Activities:
Detect processes, focus on new child processes, DLL imports, and user context. Tools like Process Hacker help visualize these processes.

Network Activities:
Malware often establishes network connections for downloading payloads, communicating with C2 servers, propagating across networks, or exfiltrating data. Tools like Wireshark and Fiddler can help analyze these connections to understand and report the malware’s network activities.

Registry Activities:
Malware exploits Windows registries for data storage and persistence. Monitor key registry locations.

• 'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'
• 'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce'
• 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run'
• 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce'

Tools like Regshot can compare registry states before and after malware execution to identify changes made by the malware.

File Activities:
Monitor directories like "Temp" and "Startup" for suspicious activities.

• '%TEMP%' for temporary files
• 'shell:startup' and 'shell:common startup' for startup directories



Step-by-Step Guide for Dynamic Malware Analysis:

1. Prepare the Analysis Environment
2. Install Analysis Tools
3. Configure Monitoring Tools
4. Execute the Malware Sample
5. Monitor and Record Behavior
6. Analyze Collected Data
7. Restore the Environment
