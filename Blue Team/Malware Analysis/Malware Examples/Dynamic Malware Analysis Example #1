
--- Dynamic Malware Analysis – Example #1 ---

Sample: e-Archive Dekont.exe
MD5: 7a0093c743fc33a5e111f2fec269f79b
SHA256: 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088

-------------------------------------------------------------------------------------------

1. Preparing the Analysis Environment
Before executing the malware, ensure all monitoring tools are running. These tools will log process, file, registry, and network activities in real-time.

Tools used:
• Process Hacker – for monitoring process activities.
• Procmon (SysInternals) – for process, file, registry, and network logging.
• RegShot – for registry snapshot comparison.
• Wireshark / Fiddler – for network activity (Fiddler is enough for HTTP).
• HashMyFiles – for file hash calculation.

Setup steps:
1. Process Hacker – Start before running the malware. Watch for new processes spawned under explorer.exe (since malware is launched from the desktop).
2. Procmon – Start logging before malware execution. Will capture terminated processes and their relationships via Show Process Tree.
3. RegShot – Take 1st shot before running the malware. This snapshot will be compared to one after execution.
4. Fiddler – Start capturing HTTP traffic.
5. Ensure the VM is isolated from the production network.

-------------------------------------------------------------------------------------------

2. Running the Malware
Execute e-Archive Dekont.exe in the virtual machine. Let it run long enough to perform its activities, then proceed to analysis.

-------------------------------------------------------------------------------------------

3. Process Activity Analysis

1. Process Hacker shows only active processes; may miss short-lived child processes.
2. Procmon’s Process Tree view reveals:
  •  PID 9076 – Original malware process.
  •  PID 4800 – schtasks.exe launched by malware.
  •  PID 7944 – Malware executable run again.

3. schtasks.exe is used to create persistence. Command line reveals a scheduled task:
Name: Updates\VbxFiQYCyFDgGL
Config file: C:\Users\Amanda\AppData\Local\Temp\tmpCCF2.tmp

4. Even if the .tmp file is deleted, the scheduled task is saved in Task Scheduler:
  •  Trigger: Runs at every logon.
  •  Action: Executes VbxFiQYCyFDgGL.exe.

-------------------------------------------------------------------------------------------

4. Network Activity Analysis

Using Fiddler, the malware connects to:

Domain: 5gw4d[.]xyz
URL: http://5gw4d[.]xyz/PL341/index.php
Protocol: HTTP

This indicates a Command & Control (C2) server.

-------------------------------------------------------------------------------------------

5. Registry Activity Analysis

Malware queries: HKLM\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall

Purpose: Enumerate installed software, possibly to target specific applications.

-------------------------------------------------------------------------------------------

6. File Activity Analysis

1. In Procmon, disable process/registry/network logs; filter by:

Operation = CreateFile

2. Malware writes a copy of itself as:

C:\Users\Amanda\AppData\Roaming\VbxFiQYCyFDgGL.exe

3. HashMyFiles confirms it’s identical to the original e-Archive Dekont.exe.
4. Reads browser/email client data files from:
  •  Firefox
  •  Chrome
  •  Thunderbird

Indicates information stealing behavior.

-------------------------------------------------------------------------------------------

7. Findings & Timeline

Observed actions:

1. Malware executed (e-Archive Dekont.exe).
2. Spawned schtasks.exe to create scheduled task Updates\VbxFiQYCyFDgGL.
3. Copied itself to %AppData%\VbxFiQYCyFDgGL.exe.
4. Set persistence to run on every logon.
5. Connected to 5gw4d[.]xyz over HTTP.
6. Enumerated installed programs via registry.
7. Accessed stored credentials/data from browsers and email clients.

-------------------------------------------------------------------------------------------

8. Indicators of Compromise (IOCs)

Hashes:
  •  MD5: 7a0093c743fc33a5e111f2fec269f79b
  •  SHA256: 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088

File Names:
  •  e-Archive Dekont.exe
  •  VbxFiQYCyFDgGL.exe

Domains: 5gw4d[.]xyz
URLs: http://5gw4d[.]xyz/PL341/index.php

Persistence Mechanism:
Scheduled Task: Updates\VbxFiQYCyFDgGL

-------------------------------------------------------------------------------------------

9. Conclusion

The analyzed sample is an information stealer that:
  •  Establishes persistence via Task Scheduler.
  •  Copies itself to %AppData%.
  •  Communicates with a C2 server over HTTP.
  •  Enumerates installed programs.
  •  Steals browser and email client data.









