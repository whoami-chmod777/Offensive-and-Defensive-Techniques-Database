
--- Dynamic Malware Analysis – Example #2 ---

Sample: Sales Order Sheet.pdf.exe
MD5: 411019bcb582ef6e3dab080d99925b4b
SHA256: f381e338212079c3a03fbbb532cdec44b1d27db03e8cc4c47408ef038885d934

-------------------------------------------------------------------------------------------

1. Preparing the Analysis Environment

Before executing the malware, ensure all monitoring tools are active to capture system events from the moment of execution.

Tools used:

• Process Hacker – monitor process activity.
• Procmon (SysInternals) – log process, file, registry, and network events.
• RegShot – compare registry state before/after execution.
• Wireshark – capture all network traffic.
• Fiddler – inspect HTTP/HTTPS requests.
• HashMyFiles – calculate file hashes.

Setup steps:

• Process Hacker – Start before running the malware. Watch for processes spawned under explorer.exe.
• Procmon – Start logging to capture even short-lived child processes (Process Tree view).
• RegShot – Take 1st shot before execution.
• Wireshark – Start packet capture.
• Fiddler – Start HTTP/S traffic logging.

Confirm VM is isolated from any production network.

-------------------------------------------------------------------------------------------

2. Running the Malware

Execute Sales Order Sheet.pdf.exe in the virtual machine. Allow sufficient runtime for malicious activities before moving to analysis.

-------------------------------------------------------------------------------------------

3. Process Activity Analysis

1. Process Hacker shows malware process:

• PID 8780 – Original malware process.
• PID 7100 – regsvcs.exe launched as a child process.

2. regsvcs.exe is a legitimate Microsoft .NET Service Installation Utility, normally found at: C:\Windows\Microsoft.NET\Framework\v4.0.30319\RegSvcs.exe

3. Hash check confirms the binary matches the genuine Microsoft version.
4. Despite being legitimate, it was spawned by malware — possible LOLBins usage or code injection.
5. Procmon filtering (Include Parent PID + Children) isolates malicious process activity.

-------------------------------------------------------------------------------------------

4. Network Activity Analysis

1. Fiddler reveals regsvcs.exe makes an HTTP request to:

• Domain: checkip.dyndns.org
  Purpose: Determine victim’s public IP.

2. Wireshark captures SMTP traffic to:

Domain: skyshine[.]com[.]my (Port 25)

3. SMTP stream analysis shows:

• From: malware process regsvcs.exe
• To: graceunlimited153@gmail[.]com
• Subject: Pc Name: admin | Snake Keylogger
• Attachments: Password.txt, User.txt (Base64-encoded credential data).

-------------------------------------------------------------------------------------------

5. Registry Activity Analysis

RegShot comparison (1st vs 2nd shot) detects changes indicating:
• Persistence-related registry modifications.
• Possible configuration entries for exfiltration targets.

-------------------------------------------------------------------------------------------

6. File Activity Analysis

1. Procmon filtering (PID 8780/7100 + CreateFile operations) shows:
• Read access to browser credential storage.
• Temporary files containing stolen credentials before exfiltration.
2. Files are later removed after being sent over SMTP.

-------------------------------------------------------------------------------------------

7. Findings & Timeline

Observed actions:
1. Malware executed (Sales Order Sheet.pdf.exe).
2. Spawned legitimate regsvcs.exe as child process.
3. Queried checkip.dyndns.org to obtain public IP.
4. Accessed and read saved browser credentials.
5. Encoded credentials into Base64 text files.
6. Connected to skyshine[.]com[.]my:25 via SMTP.
7. Sent stolen data to graceunlimited153@gmail[.]com.

-------------------------------------------------------------------------------------------

8. Indicators of Compromise (IOCs)

Hashes:
• MD5: 411019bcb582ef6e3dab080d99925b4b
• SHA256: f381e338212079c3a03fbbb532cdec44b1d27db03e8cc4c47408ef038885d934

File Names: Sales Order Sheet.pdf.exe

Domains:
• checkip.dyndns.org
• skyshine[.]com[.]my

Network:
• Protocol: SMTP (Port 25)
• Recipient Email: graceunlimited153@gmail[.]com

-------------------------------------------------------------------------------------------

9. Conclusion

The analyzed sample is Snake Keylogger, a credential-stealing malware that:
• Leverages a legitimate Windows binary (regsvcs.exe) for malicious activity.
• Collects stored browser credentials and system public IP.
• Exfiltrates data via SMTP to attacker-controlled email.
• Employs LOLBins to evade detection.

-------------------------------------------------------------------------------------------













