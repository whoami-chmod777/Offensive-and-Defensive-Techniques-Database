
Mandiant Redline is a “free endpoint security tool, that provides host investigative capabilities to users to find signs of malicious activity through memory and file analysis and the development of a threat assessment profile”. Mandiant Redline is only designed for Windows OS

Whilst Redline can be used for a number of tasks, we will specifically be using it for Perform Indicators of Compromise (IOC) analysis.


-- Installation -- 

Download the .zip archive from FireEye’s website, extract it, and run the .msi file to install Redline. Open up Redline, and follow the next steps to import an IOC file (I’m using the IOC file we created in the previous section for the image file):

- Click “Create an IOC Search Collector
- Click “Browse” in the top right corner
- Find your folder named “IOCs” and click "Select Folder"
- Select your IOC file in the left-hand window, then click “Next” in the bottom right corner


-- Getting Ready For The Hunt -- 

Now that you’ve selected your IOC file, select a location to save your IOC Collector. Before going any further, we need to go into “Edit your script” to select our file enumeration. Go under “disk” and select the boxes "Include Directories, MD5, Strings, Include Files, SHA1. Now create an empty folder, as Redline requires a base location to save all of its files and results from the hunt. Navigate anywhere and create a new folder called “Test Hunt 1”. Once you’ve done this, we can click the “Browse” button and select the new folder. Next, a popup will tell you that the Collector package has been created and saved to the location we selected.


-- Hunting with IOCs --

We have our IOCs. We have our IOC Collector base. We’re ready to hunt the system using Redline to detect the presence of our indicators of compromise. Navigate to your hunting folder, and you should see all of the collector’s files.
Now it’s time to start the audit. Type “CMD” into the Windows search bar and right-click > run as administrator. This is important because Redline needs to run as an Administrator in order to conduct all of its searches without being interrupted or denied access to certain locations. Now navigate to your hunting folder using “cd” to change directories. Starting at C:/ I had to use the following commands: cd Users > cd JBeam > cd Documents > cd "Test Hunt 1". Once you’re in the same location as the collector files, use the command .\RunRedlineAudit.bat
When you run this script Redline will get to work. You should see a new directory appear in the Collector folder named “Sessions“, a sub-folder named “AnalysisSession1“, and a file sub-folder called “Audits“. Keep refreshing this location (right-click anywhere > refresh) and you should see the size of the XML file increase, and eventually stop. The Date Modified value is useful to tell if the audit is ongoing or has finished.
When the audit has completely finished in the “AnalysisSession1” directory you will see new files appear, similar to the below screenshot. We will be using AnalysisSession1.mans to import back into Redline, allowing us to generate an IOC Report and see what we found.

Open up Redline, under the Analyze Data heading, click on Open Previous Analysis. Select your AnalysisSession1.mans file, and it will be loaded into Redline for analysis. In the bottom left corner you will see three tabs. Click on IOC Reports, and you should see a report from your hunt (if you don’t, give Redline some time to finish creating the report – you should see a popup at the bottom of the tool showing that it is working on it). Click on the IOC Report, then “View Hits +” on the right to view the results.
We’ve done it! Redline has successfully found all of our files based on the provided IOCs, including the original and two modified versions. We are able to see the file path, size, MD5 hash, user, and various important file dates.



























https://fireeye.market/
