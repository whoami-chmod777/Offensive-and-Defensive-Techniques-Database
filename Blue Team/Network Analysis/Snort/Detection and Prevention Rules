
-- Detection and Prevention Rules --

• Snort Rules Guide
• Reading Snort Log Files and Analyzing Them


-- A  Guide to Snort Rules for Intrusion Detection and Prevention --

Action: Specifies what Snort should do when a rule is triggered (alert, log, pass, drop, reject, sdrop).
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"Potential attack"; sid:1000001;)

Protocol: Defines the protocol to monitor (e.g., TCP, UDP, ICMP).
alert tcp

Source IP/Port: Defines the source IP range and port to match. any can be used as a wildcard.
alert tcp $EXTERNAL_NET any

Direction: Specifies the traffic direction (-> or <->).
-> for one-way traffic, <-> for bi-directional.

Destination IP/Port: Defines the destination IP range and port to match.
$HOME_NET 80

Message (msg): Describes the rule alert in human-readable form.
(msg:"Potential XSS Attack"; ...)

SID (sid): Unique rule identifier, required for all custom rules.
(sid:1000001;)

Rev (rev): Rule revision number for tracking changes in rule updates.
(rev:1;)

Content: Defines specific payload content to search for.
(content:"GET /admin";)

PCRE (pcre): Matches patterns using regular expressions for flexible content searches.
(pcre:"/login/i";)

Thresholding: Limits how often an alert is triggered (threshold, count, seconds).
(threshold:type limit, track by_src, count 1, seconds 60;)

Reference: Adds references to external sources, like CVEs or vendor advisories.
(reference:cve,2023-0001;)

Flow: Defines traffic flow direction (e.g., established connections only).
(flow:to_server,established;)

Classtype: Specifies a category for the alert (e.g., "attempted-admin").
(classtype:attempted-admin;)

Metadata: Provides additional information for context (policy, deployment, service).
(metadata:service http;)



-- Reading Snort Log Files and Analyzing Them --

Reads a specific Snort log file. Useful for viewing previously captured alerts or logs.
sudo snort -r /var/log/snort/snort.log.<timestamp>

Reads Snort log files in PCAP format using tcpdump. Helpful for low-level packet analysis.
sudo tcpdump -r /var/log/snort/snort.log.<timestamp>

Outputs alerts from a Snort log file directly to the console. Use -A fast for concise output.
sudo snort -A console -q -r /var/log/snort/snort.log.<timestamp>

Provides a detailed (verbose) read of packets, showing packet headers and payloads.
sudo snort -dvr /var/log/snort/snort.log.<timestamp>

Disables DNS and service resolution for faster and more straightforward output.
sudo tcpdump -nn -r /var/log/snort/snort.log.<timestamp>

Reads logs with full output (header + payload) for in-depth packet inspection.
sudo snort -A full -l /var/log/snort -r /var/log/snort/snort.log.<timestamp>

Opens Snort log in Wireshark for a graphical analysis of packets (requires wireshark installed).
wireshark /var/log/snort/snort.log.<timestamp>

Searches for alerts matching a specific SID in the alert file.
grep "sid:1000001" /var/log/snort/alert

Live-viewing new alerts as they are generated by Snort (useful for real-time monitoring).
tail -f /var/log/snort/alert



