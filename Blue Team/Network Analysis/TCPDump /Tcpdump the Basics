
--- Tcpdump the Basics ---

• Introduction
• Basic Packet Capture
• Filtering Expressions
• Advanced Filtering
• Displaying Packets
• Conclusion


-- Introduction --

The main challenge when studying networking protocols is that we don’t get a chance to see the protocol “conversations” taking place. All the technical complexities are hidden behind friendly and elegant user interfaces. 
You access resources on your local network without ever seeing an ARP query. Similarly, you would access Internet services for years without seeing a single three-way handshake till you check a networking book or inspect a network traffic capture. 
The best study aid would be capturing network traffic and taking a closer look at the various protocols; this helps us better understand how networks work.

The Tcpdump tool and its libpcap library are written in C and C++ and were released for Unix-like systems in the late 1980s or early 1990s. 
Consequently, they are very stable and offer optimal speed. The libpcap library is the foundation for various other networking tools today. Moreover, it was ported to MS Windows as winpcap.


-- Basic Packet Capture --

You can run tcpdump without providing any arguments; however, this is only useful to test that you have it installed! In any real scenario, we must be specific about what to listen to, where to write, and how to display the packets.

• Specify the Network Interface
• Save the Captured Packets
• Read Captured Packets from a File
• Limit the Number of Captured Packets
• Don’t Resolve IP Addresses and Port Numbers
• Produce (More) Verbose Output
• Summary and Examples


➜ Specify the Network Interface

The first thing to decide is which network interface to listen to using -i INTERFACE. 
You can choose to listen on all available interfaces using -i any; alternatively, you can specify an interface you want to listen on, such as -i eth0.

$ sudo tcpdump
$ sudo tcpdump -i any
$ sudo tcpdump -i ens5 

➜ Save the Captured Packets

In many cases, you should check the captured packets again later. This can be achieved by saving to a file using -w FILE. The file extension is most commonly set to .pcap. 
The saved packets can be inspected later using another program, such as Wireshark. You won’t see the packets scrolling when you choose the -w option.

$ sudo tcpdump -i ens5 -w capture.pcap
$ sudo tcpdump -i any -w traffic.pcap

➜ Read Captured Packets from a File

You can use Tcpdump to read packets from a file by using -r FILE. This is very useful for learning about protocol behaviour. 
You can capture network traffic over a suitable time frame to inspect a specific protocol, then read the captured file while applying filters to display the packets you are interested in. 
Furthermore, it might be a packet capture file that contains a network attack that took place, and you inspect it to analyze the attack.

$ sudo tcpdump -r capture.pcap
$ sudo tcpdump -r traffic.pcap port 80

➜ Limit the Number of Captured Packets

You can specify the number of packets to capture by specifying the count using -c COUNT. Without specifying a count, the packet capture will continue till you interrupt it, for example, by pressing CTRL-C. 
Depending on your goal, you only need a limited number of packets.

$ sudo tcpdump -i ens5 -c 10
$ sudo tcpdump -i ens5 -c 5 -n
$ sudo tcpdump -i any -c 50 -w sample.pcap

➜ Don’t Resolve IP Addresses and Port Numbers

Tcpdump will resolve IP addresses and print friendly domain names where possible. To avoid making such DNS lookups, you can use the -n argument. 
Similarly, if you don’t want port numbers to be resolved, such as 80 being resolved to http, you can use the -nn to stop both DNS and port number lookups

$ sudo tcpdump -i ens5 -n
$ sudo tcpdump -i ens5 -nn
$ sudo tcpdump -i ens5 -c 5 -n

➜ Produce (More) Verbose Output

If you want to print more details about the packets, you can use -v to produce a slightly more verbose output. 
According to the Tcpdump manual page (man tcpdump), the addition of -v will print “the time to live, identification, total length and options in an IP packet” among other checks. 
The -vv will produce more verbose output; the -vvv will provide even more verbosity; check the manual page for details.

$ sudo tcpdump -i ens5 -v
$ sudo tcpdump -i ens5 -vv
$ sudo tcpdump -i ens5 -vvv

➜ Summary and Examples

+-------------------------------+--------------------------------------------------------------+
| Command                       | Explanation                                                  |
+-------------------------------+--------------------------------------------------------------+
| tcpdump -i INTERFACE          | Captures packets on a specific network interface             |
| tcpdump -w FILE               | Writes captured packets to a file                            |
| tcpdump -r FILE               | Reads captured packets from a file                           |
| tcpdump -c COUNT              | Captures a specific number of packets                        |
| tcpdump -n                    | Don’t resolve IP addresses                                   |
| tcpdump -nn                   | Don’t resolve IP addresses or protocol/port numbers          |
| tcpdump -v                    | Verbose output (-vv and -vvv increase verbosity further)     |
+-------------------------------+--------------------------------------------------------------+

$ tcpdump -i ens5 -c 50 -v
$ tcpdump -i wlo1 -w data.pcap
$ tcpdump -i any -nn
$ tcpdump -i ens5 port 80
$ tcpdump -i ens5 host 192.168.1.10
$ tcpdump -i ens5 net 192.168.1.0/24
$ tcpdump -r data.pcap
$ tcpdump -i ens5 -c 100 -w sample.pcap

➜ Commands Summary

$ sudo tcpdump
$ sudo tcpdump -i any
$ sudo tcpdump -i eth0
$ sudo tcpdump -i eth0 -c 5 -n

$ sudo tcpdump -i eth0 -w capture.pcap
$ sudo tcpdump -i any -w traffic.pcap

$ sudo tcpdump -r capture.pcap
$ sudo tcpdump -r traffic.pcap port 80

$ sudo tcpdump -i eth0 -c 10
$ sudo tcpdump -i eth0 -c 5 -n
$ sudo tcpdump -i any -c 50 -w sample.pcap

$ sudo tcpdump -i eth0 -n
$ sudo tcpdump -i eth0 -nn
$ sudo tcpdump -i eth0 -c 5 -n

$ sudo tcpdump -i eth0 -v
$ sudo tcpdump -i eth0 -vv
$ sudo tcpdump -i eth0 -vvv

$ sudo tcpdump -i eth0 -c 50 -v
$ sudo tcpdump -i wlo1 -w data.pcap
$ sudo tcpdump -i any -nn
$ sudo tcpdump -i eth0 port 80
$ sudo tcpdump -i eth0 host 192.168.1.10
$ sudo tcpdump -i eth0 net 192.168.1.0/24
$ sudo tcpdump -r data.pcap
$ sudo tcpdump -i eth0 -c 100 -w sample.pcap


-- Filtering Expressions --

Although you can run tcpdump without providing any filtering expressions, this won’t be useful. 
Just like in a social gathering, you don’t try to listen to everyone at the same time; you would rather give your attention to a specific person or conversation. 
Considering the number of packets seen by our network card, it is impossible to see everything at once; we need to be specific and capture what we are interested in inspecting.

• Filtering by Host
• Filtering by Port
• Filtering by Protocol
• Logical Operators
• Summary and Examples
• Commands Summary


➜ Filtering by Host

Let’s say you are only interested in IP packets exchanged with your network printer or a specific game server. You can easily limit the captured packets to this host using host IP or host HOSTNAME.
It is important to note that capturing packets requires you to be logged-in as root or to use sudo.

If you want to limit the packets to those from a particular source IP address or hostname, you must use src host IP or src host HOSTNAME. 
Similarly, you can limit packets to those sent to a specific destination using dst host IP or dst host HOSTNAME.

$ sudo tcpdump host example.com -w http.pcap
$ sudo tcpdump src host 192.168.1.50
$ sudo tcpdump src host example.com -c 20
$ sudo tcpdump dst host 8.8.8.8
$ sudo tcpdump dst host game.server.com -w game.pcap

➜ Filtering by Port

If you want to capture all DNS traffic, you can limit the captured packets to those on port 53. Remember that DNS uses UDP and TCP ports 53 by default. 
You can limit the packets to those from a particular source port number or to a particular destination port number using src port PORT_NUMBER and dst port PORT_NUMBER, respectively.

$ sudo tcpdump src port 53
$ sudo tcpdump dst port 53
$ sudo tcpdump -i ens5 port 53 -n
$ sudo tcpdump -i ens5 udp port 53
$ sudo tcpdump -i ens5 tcp port 53 -c 20
$ sudo tcpdump src port 443 -w https_src.pcap
$ sudo tcpdump dst port 22 -nn

➜ Filtering by Protocol

You can limit your packet capture to a specific protocol; examples include: ip, ip6, udp, tcp, and icmp. 

$ sudo tcpdump -i ens5 icmp -n
$ sudo tcpdump -i ens5 tcp
$ sudo tcpdump -i ens5 udp
$ sudo tcpdump -i ens5 ip
$ sudo tcpdump -i ens5 ip6
$ sudo tcpdump icmp -c 10
$ sudo tcpdump icmp -c 10 -vv
$ sudo tcpdump tcp -w tcp_traffic.pcap
$ sudo tcpdump udp port 53 -nn
$ sudo tcpdump -r traffic.pcap arp -n
$ sudo tcpdump -r traffic.pcap arp and host 192.168.124.137 -n
$ sudo tcpdump -r traffic.pcap arp and host 192.168.124.137 -n -vv
$ sudo tcpdump -r traffic.pcap arp and dst host 192.168.124.137 -n -vv

➜ Logical Operators

Three logical operators that can be handy

• and: Captures packets where both conditions are true. For example, tcpdump host 1.1.1.1 and tcp captures tcp traffic with host 1.1.1.1.
• or: Captures packets when either one of the conditions is true. For instance, tcpdump udp or icmp captures UDP or ICMP traffic.
• not: Captures packets when the condition is not true. For example, tcpdump not tcp captures all packets except TCP segments; we expect to find UDP, ICMP, and ARP packets among the results.

$ sudo tcpdump host 1.1.1.1 and tcp
$ sudo tcpdump udp or icmp
$ sudo tcpdump not tcp
$ sudo tcpdump tcp and port 80
$ sudo tcpdump host 192.168.1.10 and not icmp
$ sudo tcpdump (udp or icmp) and host 8.8.8.8
$ sudo tcpdump not (port 22)

➜ Summary and Examples

Remember that you can count the lines by piping the output via the wc command

$ sudo tcpdump -r traffic.pcap src host 192.168.124.1 -n | wc

+--------------------------------------+--------------------------------------------------------------+
| Command                              | Explanation                                                  |
+--------------------------------------+--------------------------------------------------------------+
| tcpdump host IP                      | Filters packets by IP address or hostname                    |
| tcpdump host HOSTNAME                | Filters packets by IP address or hostname                    |
| tcpdump src host IP                  | Filters packets by a specific source host                    |
| tcpdump dst host IP                  | Filters packets by a specific destination host               |
| tcpdump port PORT_NUMBER             | Filters packets by port number                               |
| tcpdump src port PORT_NUMBER         | Filters packets by the specified source port number          |
| tcpdump dst port PORT_NUMBER         | Filters packets by the specified destination port number     |
| tcpdump PROTOCOL                     | Filters packets by protocol; examples include ip, ip6, icmp  |
+--------------------------------------+--------------------------------------------------------------+

$ sudo tcpdump -i any tcp port 22
$ sudo tcpdump -i wlo1 udp port 123
$ sudo tcpdump -i eth0 host example.com and tcp port 443 -w https.pcap

$ sudo tcpdump -r traffic.pcap -c 5 -n
$ sudo tcpdump -r traffic.pcap src host 192.168.124.1 -n
$ sudo tcpdump -r traffic.pcap src host 192.168.124.1 -n | wc

$ sudo tcpdump -r traffic.pcap dst port 80 -n
$ sudo tcpdump -r traffic.pcap tcp port 443 -n | wc -l

$ sudo tcpdump -r traffic.pcap udp -n
$ sudo tcpdump -r traffic.pcap icmp -n
$ sudo tcpdump -r traffic.pcap host 10.0.0.5 and tcp -n

➜ Commands Summary

$ sudo tcpdump host example.com -w http.pcap
$ sudo tcpdump src host 192.168.1.50
$ sudo tcpdump src host example.com -c 20
$ sudo tcpdump dst host 8.8.8.8
$ sudo tcpdump dst host game.server.com -w game.pcap

$ sudo tcpdump src port 53
$ sudo tcpdump dst port 53
$ sudo tcpdump -i eth0 port 53 -n
$ sudo tcpdump -i eth0 udp port 53
$ sudo tcpdump -i eth0 tcp port 53 -c 20
$ sudo tcpdump src port 443 -w https_src.pcap
$ sudo tcpdump dst port 22 -nn

$ sudo tcpdump -i eth0 icmp -n
$ sudo tcpdump -i eth0 tcp
$ sudo tcpdump -i eth0 udp
$ sudo tcpdump -i eth0 ip
$ sudo tcpdump -i eth0 ip6
$ sudo tcpdump icmp -c 10
$ sudo tcpdump icmp -c 10 -vv
$ sudo tcpdump tcp -w tcp_traffic.pcap
$ sudo tcpdump udp port 53 -nn
$ sudo tcpdump -r traffic.pcap arp -n
$ sudo tcpdump -r traffic.pcap arp and host 192.168.124.137 -n
$ sudo tcpdump -r traffic.pcap arp and host 192.168.124.137 -n -vv
$ sudo tcpdump -r traffic.pcap arp and dst host 192.168.124.137 -n -vv

$ sudo tcpdump host 1.1.1.1 and tcp
$ sudo tcpdump udp or icmp
$ sudo tcpdump not tcp
$ sudo tcpdump tcp and port 80
$ sudo tcpdump host 192.168.1.10 and not icmp
$ sudo tcpdump (udp or icmp) and host 8.8.8.8
$ sudo tcpdump not (port 22)

$ sudo tcpdump -i any tcp port 22
$ sudo tcpdump -i wlo1 udp port 123
$ sudo tcpdump -i eth0 host example.com and tcp port 443 -w https.pcap

$ sudo tcpdump -r traffic.pcap -c 5 -n
$ sudo tcpdump -r traffic.pcap src host 192.168.124.1 -n
$ sudo tcpdump -r traffic.pcap src host 192.168.124.1 -n | wc

$ sudo tcpdump -r traffic.pcap dst port 80 -n
$ sudo tcpdump -r traffic.pcap tcp port 443 -n | wc -l

$ sudo tcpdump -r traffic.pcap udp -n
$ sudo tcpdump -r traffic.pcap icmp -n
$ sudo tcpdump -r traffic.pcap host 10.0.0.5 and tcp -n


-- Advanced Filtering --

There are many more ways to filter packets. After all, in any real-life situation, we would need to filter through thousands or even millions of packets. It is indispensable to be able to express the exact packets to display. For example, we can limit the displayed packets to those smaller or larger than a certain length:

• greater LENGTH: Filters packets that have a length greater than or equal to the specified length
• less LENGTH: Filters packets that have a length less than or equal to the specified length

We recommend you check the pcap-filter manual page by issuing the command man pcap-filter;

• Binary Operations
• Header Bytes
• Commands Summary


➜ Binary Operations

A binary operation works on bits, i.e., zeroes and ones. An operation takes one or two bits and returns one bit. Consider the following three binary operations: &, |, and !.

& (And) takes two bits and returns 0 unless both inputs are 1

+---------+---------+------------------+
| Input 1 | Input 2 | Input1 & Input 2 |
+---------+---------+------------------+
|    0    |    0    |        0         |
|    0    |    1    |        0         |
|    1    |    0    |        0         |
|    1    |    1    |        1         |
+---------+---------+------------------+

| (Or) takes two bits and returns 1 unless both inputs are 0.

+---------+---------+------------------+
| Input 1 | Input 2 | Input1 | Input 2 |
+---------+---------+------------------+
|    0    |    0    |        0         |
|    0    |    1    |        1         |
|    1    |    0    |        1         |
|    1    |    1    |        1         |
+---------+---------+------------------+

! (Not) takes one bit and inverts it; an input of 1 gives 0, and an input of 0 gives 1.

+---------+----------+
| Input 1 | !Input 1 |
+---------+----------+
|    0    |    1     |
|    1    |    0     |
+---------+----------+

➜ Header Bytes

The purpose of this section is to be able to filter packets based on the contents of a header byte. Consider the following protocols: ARP, Ethernet, ICMP, IP, TCP, and UDP. 

How can we tell Tcpdump to filter packets based on the contents of protocol header bytes? 

Using pcap-filter, Tcpdump allows you to refer to the contents of any byte in the header using the following syntax proto[expr:size], where:

• proto refers to the protocol. For example, arp, ether, icmp, ip, ip6, tcp, and udp refer to ARP, Ethernet, ICMP, IPv4, IPv6, TCP, and UDP respectively.
• expr indicates the byte offset, where 0 refers to the first byte.
• size indicates the number of bytes that interest us, which can be one, two, or four. It is optional and is one by default.

To better understand this, consider the following two examples from the pcap-filter manual page:

• ether[0] & 1 != 0 takes the first byte in the Ethernet header and the decimal number 1 (i.e., 0000 0001 in binary) and applies the & (the And binary operation). 
It will return true if the result is not equal to the number 0 (i.e., 0000 0000). The purpose of this filter is to show packets sent to a multicast address. 
A multicast Ethernet address is a particular address that identifies a group of devices intended to receive the same data.

• ip[0] & 0xf != 5 takes the first byte in the IP header and compares it with the hexadecimal number F (i.e., 0000 1111 in binary). 
It will return true if the result is not equal to the (decimal) number 5 (i.e., 0000 0101 in binary). The purpose of this filter is to catch all IP packets with options.

You can use tcp[tcpflags] to refer to the TCP flags field. The following TCP flags are available to compare with:

• tcp-syn TCP SYN (Synchronize)
• tcp-ack TCP ACK (Acknowledge)
• tcp-fin TCP FIN (Finish)
• tcp-rst TCP RST (Reset)
• tcp-push TCP Push

Based on the above, we can write:

• tcpdump "tcp[tcpflags] == tcp-syn" to capture TCP packets with only the SYN (Synchronize) flag set, while all the other flags are unset.
• tcpdump "tcp[tcpflags] & tcp-syn != 0" to capture TCP packets with at least the SYN (Synchronize) flag set.
• tcpdump "tcp[tcpflags] & (tcp-syn|tcp-ack) != 0" to capture TCP packets with at least the SYN (Synchronize) or ACK (Acknowledge) flags set.

➜ Commands Summary

$ sudo tcpdump "tcp[tcpflags] == 0"
$ sudo tcpdump "tcp[tcpflags] == tcp-syn"
$ sudo tcpdump -r traffic.pcap "tcp[tcpflags] == tcp-rst"
$ sudo tcpdump -r traffic.pcap greater 15000 -n
$ sudo tcpdump -r traffic.pcap "ip[2:2] > 15000" -n

$ sudo tcpdump -i eth0 "tcp[tcpflags] == tcp-syn"
$ sudo tcpdump -i eth0 "tcp[tcpflags] == (tcp-syn|tcp-ack)"

$ sudo tcpdump "tcp[tcpflags] & (tcp-syn|tcp-ack) != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-ack != 0 and tcp[tcpflags] & tcp-syn == 0"

$ sudo tcpdump "tcp[tcpflags] & tcp-syn != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-fin != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-rst != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-push != 0"

$ sudo tcpdump "tcp[tcpflags] & tcp-fin != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-rst != 0"
$ sudo tcpdump "tcp[tcpflags] & tcp-push != 0"

$ sudo tcpdump "ip[6:2] & 0x1fff != 0"
$ sudo tcpdump "ip[8] < 5"
$ sudo tcpdump "ip[0] & 0xf != 5"
$ sudo tcpdump "icmp[0] == 8"
$ sudo tcpdump "icmp[0] == 0"

$ sudo tcpdump "udp[8:2] > 512"
$ sudo tcpdump "tcp[13] == 2"
$ sudo tcpdump "tcp[13] == 18"
$ sudo tcpdump "tcp[13] & 4 != 0"
$ sudo tcpdump -r traffic.pcap arp and arp[6:2] = 1 -e -n

$ sudo tcpdump -i any "tcp[tcpflags] & tcp-syn != 0"
$ sudo tcpdump -r traffic.pcap "tcp[tcpflags] & tcp-ack != 0"


-- Displaying Packets --

Tcpdump is a rich program with many options to customize how the packets are printed and displayed. 

• -q: Quick output; print brief packet information
• -e: Print the link-level header
• -A: Show packet data in ASCII
• -xx: Show packet data in hexadecimal format, referred to as hex
• -X: Show packet headers and data in hex and ASCII

• Brief Packet Information
• Displaying Link-Level Header
• Displaying Packets as ASCII
• Displaying Packets in Hexadecimal Format
• Best of Both Worlds
• Summary and Examples
• Commands Summary
           
$ tcpdump -r TwoPackets.pcap
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25
18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29

        
➜ Brief Packet Information

If you prefer shorter output lines, you can opt for “quick” output with -q. 
           
$ tcpdump -r TwoPackets.pcap -q
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 IP 104.18.12.149.https > g5000.45248: tcp 25
18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: tcp 29

➜ Displaying Link-Level Header        

If you are on an Ethernet or WiFi network and want to include the MAC addresses in Tcpdump output, all you need to do is to add -e. This is convenient when you are learning how specific protocols, such as ARP and DHCP function. 
It can also help you track the source of any unusual packets on your network.

$ tcpdump -r TwoPackets.pcap -e
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 44:df:65:d8:fe:6c (oui Unknown) > 02:83:1e:40:5d:17 (oui Unknown), ethertype IPv4 (0x0800), length 91: 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25
18:59:59.980574 02:83:1e:40:5d:17 (oui Unknown) > 44:df:65:d8:fe:6c (oui Unknown), ethertype IPv4 (0x0800), length 95: g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29

➜ Displaying Packets as ASCII      

ASCII stands for American Standard Code for Information Interchange; ASCII codes represent text. In other words, you can expect -A to display all the bytes mapped to English letters, numbers, and symbols.
           
$ tcpdump -r TwoPackets.pcap -A
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25
E..M..@.5..)h.....BY.......|.;5}...........
..1...k......j.3.2.....&9a.....-L
18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29
E..Ql.@.@.VV..BYh........;5}...............
..k...1.......1.y.&VC<#._J$..z...D#.`

➜ Displaying Packets in Hexadecimal Format

To display the packets in hexadecimal format, we must add -xx. Adding -xx lets us see the packet octet by octet.
           
$ tcpdump -r TwoPackets.pcap -xx
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25
        0x0000:  0283 1e40 5d17 44df 65d8 fe6c 0800 4500
        0x0010:  004d fbd8 4000 3506 d229 6812 0c95 c0a8
        0x0020:  4259 01bb b0c0 a0b1 037c aa3b 357d 8018
        0x0030:  0010 f905 0000 0101 080a 189a 310d ebfa
        0x0040:  6b2e 1703 0300 146a 8f33 1832 e6a2 fb99
        0x0050:  eb26 3961 dad4 1611 152d 4c
18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29
        0x0000:  44df 65d8 fe6c 0283 1e40 5d17 0800 4500
        0x0010:  0051 6ca8 4000 4006 5656 c0a8 4259 6812
        0x0020:  0c95 b0c0 01bb aa3b 357d a0b1 0395 8018
        0x0030:  087f 17e0 0000 0101 080a ebfa 6be8 189a
        0x0040:  310d 1703 0300 18f4 31fa 798d 2656 433c
        0x0050:  2389 5f4a 24c2 fa7a 1496 8444 238e 60

➜ Best of Both Worlds

If you would like to display the captured packets in hexadecimal and ASCII formats, Tcpdump makes it easy with the -X option.
           
$ tcpdump -r TwoPackets.pcap -X
reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144
18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25
        0x0000:  4500 004d fbd8 4000 3506 d229 6812 0c95  E..M..@.5..)h...
        0x0010:  c0a8 4259 01bb b0c0 a0b1 037c aa3b 357d  ..BY.......|.;5}
        0x0020:  8018 0010 f905 0000 0101 080a 189a 310d  ..............1.
        0x0030:  ebfa 6b2e 1703 0300 146a 8f33 1832 e6a2  ..k......j.3.2..
        0x0040:  fb99 eb26 3961 dad4 1611 152d 4c         ...&9a.....-L
18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29
        0x0000:  4500 0051 6ca8 4000 4006 5656 c0a8 4259  E..Ql.@.@.VV..BY
        0x0010:  6812 0c95 b0c0 01bb aa3b 357d a0b1 0395  h........;5}....
        0x0020:  8018 087f 17e0 0000 0101 080a ebfa 6be8  ..............k.
        0x0030:  189a 310d 1703 0300 18f4 31fa 798d 2656  ..1.......1.y.&V
        0x0040:  433c 2389 5f4a 24c2 fa7a 1496 8444 238e  C<#._J$..z...D#.
        0x0050:  60

➜ Summary and Examples

+--------------+------------------------------------------------------+
| Command      | Explanation                                          |
+--------------+------------------------------------------------------+
| tcpdump -q   | Quick and quiet: brief packet information            |
| tcpdump -e   | Include MAC addresses                                |
| tcpdump -A   | Print packets as ASCII encoding                      |
| tcpdump -xx  | Display packets in hexadecimal format                |
| tcpdump -X   | Show packets in both hexadecimal and ASCII formats   |
+--------------+------------------------------------------------------+

➜ Commands Summary

$ tcpdump -r TwoPackets.pcap
$ tcpdump -r TwoPackets.pcap -q
$ tcpdump -r TwoPackets.pcap -e
$ tcpdump -r TwoPackets.pcap -A
$ tcpdump -r TwoPackets.pcap -xx
$ tcpdump -r TwoPackets.pcap -X


-- Conclusion --









https://www.tcpdump.org/manpages/pcap-filter.7.html
https://www.tcpdump.org/manpages/tcpdump.1.html


*


