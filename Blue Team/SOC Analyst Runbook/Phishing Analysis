
-- Phishing Analysis --

â€¢ Core Tools
â€¢ Step-by-Step Procedure
  â†’ Header Analysis
  â†’ URL & Domain Analysis
  â†’ Attachment Analysis
  â†’ Decision & Action
  â†’ Documentation



ğŸ§° Core Tools

â€¢ PhishTool â€“ Automated artifact extraction & analysis
â€¢ WHOIS / nslookup / dig â€“ Domain & registrar information
â€¢ URLScan.io / URL2PNG â€“ URL reputation & screenshot capture
â€¢ VirusTotal â€“ File & URL reputation
â€¢ OSINT Tools â€“ Domain history, IP lookup, threat feeds
â€¢ Sandbox (Any.Run / Joe Sandbox) â€“ File detonation
â€¢ Email Header Analyzer â€“ SPF/DKIM/DMARC inspection


ğŸ§© Step-by-Step Procedure

1ï¸âƒ£ Collect Artifacts

Save full .eml / .msg file
Extract headers, body, URLs, attachments

grep -Eo "https?://[^\"'<> ]+" suspicious.eml > urls.txt
sed -n '1,200p' suspect.eml
ripmime -i suspicious.eml -d ./artifacts

dig +short TXT $(echo "example.com" | sed 's/^/._spf./')  


2ï¸âƒ£ Header Analysis

rg -o 'https?://[^ >]+' mail.eml | sort -u
grep -Ei "Received:|From:|Reply-To:|Return-Path:" suspicious.eml

For Short-URLs: curl -I <shorturl> in a Sandbox 

Verify domains via whois / dig:
â€¢ whois bad-domain.com
â€¢ dig bad-domain.com any

https://mxtoolbox.com/EmailHeaders.aspx


2ï¸âƒ£ Sender-Authentifizierung prÃ¼fen

Check SPF, DKIM, DMARC results in headers

Received-SPF: Pass/Fail
Authentication-Results: dkim=pass/fail; dmarc=pass/fail


3ï¸âƒ£ URL & Domain Analysis

grep -Eo '(http|https)://[^ ]+' email.eml > urls.txt
grep -Eo "https?://[^\"\'\s]+" suspect.eml | sort -u
grep -Eo "https?://[^ >'\"]+" suspect.eml | sort -u > urls.txt
curl -I <url>

while read u; do host=$(echo $u | sed -E 's#https?://([^/]+)/.*#\1#'); echo "$u -> $host"; dig +short $host; whois $host; done < urls.txt

Scan URLs:
â€¢ urlscan.io
â€¢ https://www.virustotal.com/gui/home/url

Capture screenshots: url2png.com

Check age & registration of domain (young domains â†’ suspicious)

https://urlscan.io/


3ï¸âƒ£ Attachment-Analyse

exiftool attachment.doc
oleid attachment.doc
pdfid attachment.pdf

sha256sum attachment.doc
sha1sum attachment.doc
md5sum attachment.doc

curl -s --request POST --url https://www.virustotal.com/api/v3/files


3ï¸âƒ£ Dynamic Sandbox

â€¢ Upload to Any.Run, Cuckoo, or Hybrid Analysis

Check for:
â€¢ Created processes
â€¢ Network traffic (C2)
â€¢ Dropped files
â€¢ Registry edits


4ï¸âƒ£ Attachment Analysis

Hash and scan file:
md5sum attachment.docx
sha256sum attachment.docx
  â†’ Lookup on VirusTotal.

Sandbox test in Any.Run / Cuckoo / Hybrid Analysis

If executable â†’ static check: strings -n 8 attachment.exe | less


5ï¸âƒ£ Decision & Action

If malicious indicators found:
â€¢ Block sender & domain (mail gateway)
â€¢ Block URLs (proxy/DNS firewall)
â€¢ Reset affected user passwords
â€¢ Notify users (awareness)
â€¢ Share IOCs with Threat Intel team


6ï¸âƒ£ Documentation

â€¢ Record all findings (headers, hashes, URLs, timestamps)
â€¢ Save evidence in case folder
â€¢ Example report fields:
  â†’ Header summary
  â†’ Artifact table (hashes, domains)
  â†’ Analysis result
  â†’ Recommended controls
