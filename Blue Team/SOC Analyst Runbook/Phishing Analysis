
-- Phishing Analysis --

‚Ä¢ Core Tools
‚Ä¢ Step-by-Step Procedure
  ‚Üí Header Analysis
  ‚Üí URL & Domain Analysis
  ‚Üí Attachment Analysis
  ‚Üí Decision & Action
  ‚Üí Documentation



üß∞ Core Tools

‚Ä¢ PhishTool ‚Äì Automated artifact extraction & analysis
‚Ä¢ WHOIS / nslookup / dig ‚Äì Domain & registrar information
‚Ä¢ URLScan.io / URL2PNG ‚Äì URL reputation & screenshot capture
‚Ä¢ VirusTotal ‚Äì File & URL reputation
‚Ä¢ OSINT Tools ‚Äì Domain history, IP lookup, threat feeds
‚Ä¢ Sandbox (Any.Run / Joe Sandbox) ‚Äì File detonation
‚Ä¢ Email Header Analyzer ‚Äì SPF/DKIM/DMARC inspection


üß© Step-by-Step Procedure

1Ô∏è‚É£ Collect Artifacts

Save full .eml / .msg file
Extract headers, body, URLs, attachments

ripmime -i suspicious.eml -d ./artifacts
grep -Eo "https?://[^\"'<> ]+" suspicious.eml > urls.txt


2Ô∏è‚É£ Header Analysis

rg -o 'https?://[^ >]+' mail.eml | sort -u
grep -Ei "Received:|From:|Reply-To:|Return-Path:" suspicious.eml

For Short-URLs: curl -I <shorturl> in a Sandbox 

Verify domains via whois / dig:
‚Ä¢ whois bad-domain.com
‚Ä¢ dig bad-domain.com any

https://mxtoolbox.com/EmailHeaders.aspx


2Ô∏è‚É£ Sender-Authentifizierung pr√ºfen

Check SPF, DKIM, DMARC results in headers

Received-SPF: Pass/Fail
Authentication-Results: dkim=pass/fail; dmarc=pass/fail


3Ô∏è‚É£ URL & Domain Analysis

grep -Eo '(http|https)://[^ ]+' email.eml > urls.txt
curl -I <url>

Scan URLs:
‚Ä¢ urlscan.io
‚Ä¢ https://www.virustotal.com/gui/home/url

Capture screenshots: url2png.com

Check age & registration of domain (young domains ‚Üí suspicious)

https://urlscan.io/


3Ô∏è‚É£ Attachment-Analyse

exiftool attachment.doc
oleid attachment.doc
pdfid attachment.pdf

sha256sum attachment.doc
curl -s --request POST --url https://www.virustotal.com/api/v3/files


3Ô∏è‚É£ Dynamic Sandbox

‚Ä¢ Upload to Any.Run, Cuckoo, or Hybrid Analysis

Check for:
‚Ä¢ Created processes
‚Ä¢ Network traffic (C2)
‚Ä¢ Dropped files
‚Ä¢ Registry edits


4Ô∏è‚É£ Attachment Analysis

Hash and scan file:
md5sum attachment.docx
sha256sum attachment.docx
  ‚Üí Lookup on VirusTotal.

Sandbox test in Any.Run / Cuckoo / Hybrid Analysis

If executable ‚Üí static check: strings -n 8 attachment.exe | less


5Ô∏è‚É£ Decision & Action

If malicious indicators found:
‚Ä¢ Block sender & domain (mail gateway)
‚Ä¢ Block URLs (proxy/DNS firewall)
‚Ä¢ Reset affected user passwords
‚Ä¢ Notify users (awareness)
‚Ä¢ Share IOCs with Threat Intel team


6Ô∏è‚É£ Documentation

‚Ä¢ Record all findings (headers, hashes, URLs, timestamps)
‚Ä¢ Save evidence in case folder
‚Ä¢ Example report fields:
  ‚Üí Header summary
  ‚Üí Artifact table (hashes, domains)
  ‚Üí Analysis result
  ‚Üí Recommended controls
