
--- Detecting Command Injection Attacks ---

• What are Command Injection Attacks
• How does Command Injection work
• How attackers can exploit Command Injection Attacks
• How to Prevent Command Injection
• Detecting Command Injection Attacks
• 
• 
• 
• 


-- What are Command Injection Attacks --

Command injection attacks are attacks that occur when data received from a user is not sanitized and is passed directly to the operating system shell.
Attackers exploit command injection vulnerabilities to execute commands directly on the operating system. Since the attacker's priority is to take control of the system, these vulnerabilities are more critical than other vulnerabilities.
A misconfigured web application would grant the attacker access with admin rights because the command the attacker sends uses the rights of the web application user.


-- How does Command Injection work --

Command injection vulnerabilities occur when the data received from the user is not sanitized.
Suppose we have a basic web application that copies the user's file to the "/tmp" folder. The web application code is shown below:

<?php

$file_name = $_POST['file_name'];
$output = shell_exec("cp $file_name /tmp/");

?>

Under normal circumstances, if used correctly, the application will work normally. For example, if we upload a file called "letsdefend.txt", it will successfully copy the file to the "/tmp" folder.

So what if we upload a file called "letsdefend;ls;.txt"? The command would be:
Command: cp letsdefend;ls;.txt

The ";" indicates that the command has ended. So if we look at the payload above, there are three different commands that the operating system executes. These are:

• cp letsdefend
• ls
• .txt

The first command is for the copying process, but if the parameters are not entered correctly it will not work correctly.
Command #2 is the directory listing command that the attacker wants to execute. The user does not receive the command output, so the attacker cannot see the files in the directory, but the operating system successfully executes the command.
If the operating system tries to run command number 3, it will get an error message because there is no ".txt" command.
As you can see, the code has been executed in the web server's operating system. So what if the attacker were to upload a file called "letsdefend;shutdown;.txt"? The operating system would shut down and the web application would not be able to function.
With the correct payload, the attacker can create a reverse shell in the operating system.


-- How attackers can exploit Command Injection Attacks --

Attackers can execute commands on an operating system by exploiting command injection vulnerabilities. This means that the web application and all other components on the server are at risk.


-- How to Prevent Command Injection --

• Always sanitize data you receive from a user: Never trust anything you receive from a user. Not even a file name!
• Limit user privileges: Whenever possible, set web application user rights at a lower level. Few web applications require users to have administrator rights. 
• Use virtualization technologies such as dockers.


-- Detecting Command Injection Attacks --















