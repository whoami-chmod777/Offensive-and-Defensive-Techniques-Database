
-- Network Discovery --

net view /all
net view
net view \\HOSTNAME
net share
net session
wmic volume list brief
wmic share get
wmic logicladisk get


-- Scan --

nbtstat -A indirizzoip
for /L %I in (1,1,254) do ping -w 30 -n 1 192.168.1.%I | find "Reply" >> nomefile.txt
nbtstat -c
for /L %I in (1,1,254) do nbtstat -An 192.168.1.%I

netsh wlan show profile
netsh wlan show profile nomedelprofilo key=clear


-- Network --

netstat -e
netstat -nr
netstat -naob
netstst -S
netstat -vb
route print
arp -a
ipconfig /all
netsh wlan show interfaces
netsh wlan show all


-- Start/Stop Firewall --

netsh advfirewall show rule name=all
netsh advfirewall set allprofile state off
netsh advfirewall set allprofile state on
netsh advfirewall set publicprofile state on
netsh advfirewall set privateprofile state on
netsh advfirewall set domainprofile state on
netsh advfirewall firewall add rule name="Open Port 80" dir=in action=allow protocol=TCP localport=80
netsh advfirewall firewall add rule name="My Application" dir=in action=allow program="C:\MyApp\MyApp.exe" enable=yes


-- Users --

net users
net localgroup administrators
net group administrators

net user /add username password
net localgroup administrators username /add

net user username
net user username newpassword

wmic rdtoggle list
wmic useraccount list
wmic group list
wmic netlogin get name,lastlogin,badpasswordcount
wmic netclient list brief
wmic nicconfig get
wmic netuse get


-- Show File Content --

type file.txt


-- Services --

at
tasklist
tasklist /svc
schtask
net start
sc query

wmic service list brief | findstr "Running"
wmic service list brief | findstr "Stopped"
wmic service list config
wmic service list brief
wmic service list status
wmic service list memory
wmic job list brief


-- Start/Stop Service --

sc config "service name" start= disable
sc stop "service name"
wmic service where name='service name' call ChangeStartMode Disabled


-- Autorun and Autoload --

wmic startup list full
wmic ntdomain list brief


-- Registry --

Read Registry Entries: 
reg query "HKCU\Control Panel\Desktop"

Enable/Disable Remote Desktop:
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 1 /f

Enable Remote Assistance:
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f


-- Shadow Files --

vssadmin List ShadowStorage
vssadmin List Shadow
net start VSS

Policy, patch:
set
gpresult /r
systeminfo
wmic qfe


-- Reboot --

shutdown.exe /r


-- Settings of security log --

wevtutil gl Security


-- Settings of audit policies --

auditpool /get /category:*


-- System Info --

echo %DATE% %TIME%
hostname
systeminfo
wmic csproduct get name
wmic bios get serialnumber
wmic computersystem list brief

