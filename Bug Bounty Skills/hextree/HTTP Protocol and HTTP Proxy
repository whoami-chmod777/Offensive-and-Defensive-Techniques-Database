
--- HTTP Protocol and HTTP Proxy ---

We are exploring the basics of HTTP by looking at the raw TCP communication. After that we learn how an HTTP proxy works, which helps us understand how modern proxy tools for web hacking work.

• HTTP Protocol
• HTTP in tcpdump and Wireshark
• Sending HTTP Requests by Hand
• Custom HTTP header
• Raw HTTP Request and Responses with Netcat
• Cookies
• 


-- HTTP Protocol --

nc -v -l 0.0.0.0 80
ps -aux

service nginx status
ps -aux | grep nginx
nc -v -l 0.0.0.0 80

service nginx stop
service nginx start
service nginx status

***************************************
nc -v -l 0.0.0.0 80

HTTP/1.1 200 OK
Content-Type: text/html

<h1>This is a HTTP response</h1>
<p>This is some text</p>
***************************************


-- HTTP in tcpdump and Wireshark --

apt update
apt install tcpdump

tcpdump -i any 'tcp port 80' -v -A
tcpdump -i any 'tcp port 80' -v -A -w tcpdump.pcap
tcpdump -i any 'tcp port 80' -v -A -r tcpdump.pcap

http.request.method == "GET"
http.host matches "blogger2"


-- Sending HTTP Requests by Hand --

nc blogger2-idhh5vd4yne4o.hexbirch.com 80
nc -v blogger2-idhh5vd4yne4o.hexbirch.com 80

curl -v http://blogger2-idhh5vd4yne4o.hexbirch.com/
curl -v https://blogger2-rl3lv6nw7og6u.hexbirch.com/photos/ \ -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36
curl -v https://blogger2-rl3lv6nw7og6u.hexbirch.com/photos/ -H "Cookie: admin_sessionid=HXT{this-is-a-secret-value-f59661f0}"


-- Custom HTTP Header --

DevTools → Network → select a request → Headers → Response Headers


-- Raw HTTP Request and Responses with Netcat --

nc -v -l 0.0.0.0 80

HTTP/1.1 200 OK
X-Hextree: http test response
Content-Type: text/html

<h1>This is HTTP Response</h1>
<p>typing some response text</p>


HTTP Request (browser → server)
The browser requested a document from the server via a GET request, sent via TCP to port 80.

GET / HTTP/1.1
Host: www-qqrlyvwmcmg7c.hexbirch.com
X-Forwarded-For: 89.44.188.231
X-Forwarded-Host: www-qqrlyvwmcmg7c.hexbirch.com
X-Forwarded-Server: www-qqrlyvwmcmg7c.hexbirch.com
X-Forwarded-Proto: http
X-Forwarded-Port: 80
X-Scheme: http
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9

HTTP Response (server → browser)
The webserver looks at the request and prepares a response following the HTTP protocol standard. For example, it could return HTML code.

HTTP/1.1 200 OK
X-Hextree: http test response
Content-Type: text/html

<h1>This is HTTP Response</h1>
<p>typing some response text</p>


-- Cookies --

If a cookie for a domain is stored by the browser, the browser will always send this header along each HTTP request. Because this cookie is not set automatically, we can use the developer tools to set this cookie by hand.

→ DevTools → Application → Cookies
→ Select the site
→ Double-click the cookie value to edit, or right-click → Add to create a new cookie with name admin_sessionid and your value
→ Reload the page → the browser will send it automatically
→ Cookie: admin_sessionid=HXT{this-is-a-secret-value-f59661f0}





















