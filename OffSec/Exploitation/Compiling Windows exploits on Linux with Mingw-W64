
--- Compiling Windows exploits on Linux with Mingw-W64 ---

• Installing Mingw-w64 on Kali Linux
• How to compile Windows exploits
• Compilation options


You will need to be able to compile executable Windows exploits on your Linux machine without the need for a complete Windows development environment.
When we’re compiling source code for a platform or architecture different to the one on which the compiler is running, the process is called ‘cross compilation’. In this section we will learn how to cross-compile Windows exploits on Linux using a Windows privilege escalation exploit.
A very popular tool to cross compile Windows exploits on Linux is called Mingw-w64 (Minimalist GNU for Windows). Mingw-w64 is a free and open source software development environment for creating Windows applications.


-- Installing Mingw-w64 on Kali Linux --

Mingw-w64 is not installed by default on Kali Linux or on most other penetration testing distributions. MingW-w64 installation is very straightforward using the package manager.

sudo apt-get update
sudo apt-get install mingw-w64

sudo apt update
sudo apt upgrade -y
sudo apt install gcc-mingw-w64


-- Compiling the exploit --

The first step is to download the exploit source code from Exploit-db with wget. The exploit code is written in the C language so we’ll store the code with the .c extension by specifying the –output-document option (or simply -O) as in the following command:
Once the file with the source code has been downloaded, the next step is to compile the exploit. To do this we must specify the input file (the exploit code we’ve just downloaded), the output file (-o option) and, finally, the ‘-lws2_32’ option

i686-w64-mingw32-gcc [input file: source] -o [output file: .exe] -lws2_32

wget https://www.exploit-db.com/download/40564 -O 40564.c
i686-w64-mingw32-gcc 40564.c -o exploit.exe -lws2_32


-- Compilation options --

You might be wondering how to determine which compile options to use with Mingw or GCC.

-lws2_32

The -l option is for naming the libraries/dlls you want to link. In this case –l references the 32-bit winsock dll (ws2_32). As mentioned earlier, many, if not most, of the exploits on Exploit-db contain comments by the developer of the exploit with exact instructions on how to compile the exploit, including the required options to use. Therefore, it is recommended to read carefully through the comment sections in the exploit code to find information on how to compile the exploit.




























