
Statistically, most organizations are using Windows operating systems on servers and workstations. But if you take a broader look at the complete infrastructure you will also encounter a lot of devices running on Linux. Examples of devices that are very likely to run a Linux operating system are firewalls, routers, VOIP servers, NAS and webservers. These kinds of devices are very critical for a company’s infrastructure with severe consequences when they are compromised.

It happens very often that system administrators in Windows environments overlook the Linux devices for many reasons. One of these reasons is the lack of knowledge about how to maintain Linux systems and how to secure them. This can result in critical Linux devices being the weakest link in the security chain and become a great security threat. Therefore, it is very important as a penetration tester to focus not only on Windows systems because they cover 90% of the company’s devices but also on (critical) Linux systems.

The most common ways of privilege escalation on Linux systems are leveraging kernel vulnerabilities, misconfigurations and vulnerable software to execute arbitrary code under root privileges. New kernel vulnerabilities occur on a regular basis and often involve a wide range of kernel versions. A recently discovered example of a kernel vulnerability allowing for privilege escalation is the DirtyCOW vulnerability affecting hundreds of Linux kernel versions. Also misconfigurations in files, services and security mechanisms and out of date software commonly allow for privilege escalation.


• Gather system information for privilege escalation
• Collecting system information manually
• Users
• Networking information
• Applications and services
• Files and file systems
• 
• 
• 
• 
• 
• 
• 

⇒

-- Gather system information for privilege escalation --

Services running with root privileges are of especial interest for privilege escalation. When we can exploit a service running as root to execute arbitrary commands they will be executed as root. Applications that are configured to be executed with higher privileges using a Linux feature named SUID are also very useful.

For effective privilege escalation in Linux the system information you should know includes:

• Distribution type
• Kernel version
• Running applications and services
• Weak file permissions
• Scheduled jobs
• Other important information about the system.


-- Collecting system information manually --

➜ OS, Kernel & Hostname

cat /etc/issue
cat /proc/version
cat /etc/centos-release
hostname
uname -a

⇒ On Exploit-db or with searchsploit: 

searchsploit linux kernel 3.9
searchsploit --exclude="/dos/" "linux kernel 3.9"

Google Search: CentOS 7.0.1406 privilege escalation

Search Exploit-DB on the kernel version from narrow to wide with the ‘local’ filter to ensure the exploits are local exploits only. 

Linux kernel 3.10.0-123 // No results.
Linux kernel 3.10.0     // 1 local exploit matching the kernel version.
Linux kernel 3.10       // No results that match the CentOS 7 operating system.

+-------+----------+--------+------+-----+
| Type  | Platform | Author | Port | Tag | 
+-------+----------+--------+------+-----+
| local | Any      |        | Any  | Any |
+-------+----------+--------+------+-----+


-- Users --

The passwd file stores essential user account information required during login. The passwd file is stored in the /etc directory and contains information such as the user ID, group ID, home directory and the path to the command shell. An ‘x’ character means that the encrypted password is stored in the /etc/shadow file.

cat /etc/passwd

Make sure you pay attention to the groups to which the privileged user belongs. One especially important group is the sudo (‘Super User Do’) group. A user that is member of the sudo group is able to execute commands in the context of the root user without providing the root password – depending on the settings in the sudoer file you may only need to enter the password for the current user or none at all.

id
who
w
sudo -l

useraccount ALL=/usr/bin/apt-get,/sbin/shutdown


-- Networking information --

ifconfig -a
route
netstat -antup
arp -e


-- Applications and services --

Knowing which services are running with root privileges can be very important for privilege escalation because exploiting them will result in root level access.

Joomla installations contain a configuration file named 'configuration.php' and WordPress uses the 'wp-config.php' file for this purpose. 
These configuration files contain valuable information such as the MySQL username and password.

ps aux
ps aux | grep

Debian and derivatives use: dpkg -l
Fedora based distros use: rpm -qa

ls -ls /etc/ | grep .conf
ls -ls /var/www/html/

find /* -user root -perm -4000 -print 2>/dev/null


-- Files and file systems --



































https://www.exploit-db.com/
https://www.exploit-db.com/searchsploit


*






















