
--- Vulnerability Scanning with OpenVAS ---

Automated techniques can help you to find vulnerabilities easily overlooked during a manual assessment. 
OpenVAS is an advanced open-source vulnerability scanner and manager that can save you a lot of time when performing a vulnerability assessment on a specific host or network range.

• Installing OpenVAS 11 on Kali Linux
• Starting and stopping OpenVAS services
• Connecting to the web interface
• Scanning Metasploitable 2 with OpenVAS
• Scan configurations

Note: Kali Linux VHL VM
At the time of writing, the installation process of OpenVAS/Greenbone Vulnerability Management (GVM) does not work correctly on the VHL Kali Linux virtual machines without running a dist-upgrade and creating a new sudo user to install OpenVAS/GVM. Upgrading your VM may causes issues and therefore we recommend to download and install a fresh Kali Linux 2025 virtual machine to run OpenVAS/GVM. If you decide to upgrade your current virtual machine, please consider making a back-up or snapshot so you can revert back to a working virtual machine when issues occur.


-- Installing OpenVAS 11 on Kali Linux --

Run the following commands to download and install OpenVAS on your Kali Linux machine:

sudo apt-get update
sudo apt-get install gvm
sudo gvm-setup
sudo gvm-start

sudo netstat -antup


-- Starting and stopping OpenVAS services --

sudo gvm-start
sudo gvm-stop


-- Connecting to the web interface --

Once the OpenVAS services have started, open a web browser and enter the following address: https://127.0.0.1:9392
Your browser may state that the security certificate is invalid. Create a security exception and sign in with the username 'admin' and the password generated during the setup process.

Note: Your browser will state that the connection is not secure due to an invalid SSL certificate because it has a self-signed certificate. You can safely accept this warning and add an exception for the certificate.


-- Scanning Metasploitable 2 with OpenVAS --

In earlier versions entering a hostname or IP and hitting the scan button was enough to get OpenVAS started, but now, before we can run a scan, we must:

1. Create and configure a scan task.
2. Create and configure a target.
3. Optionally create a custom scan configuration or use one of the default configurations

To create a new task, click the 'Tasks' option in the 'Scans' dropdown menu. Then click the button with the 'new document' icon in the top left corner of the page and choose 'New Task'

This will open a new menu where we can define parameters for the new scanning task. After naming our task we have first to create a new target and specify a few parameters. Instead of creating a target on the target page (Menu item Configuration -> Targets) we can also create a new target by clicking the star icon to the right of the ‘Scan Targets’ field

This will open another menu where we can specify the target settings. For this demonstration we’ve named the target ‘Metasploitable 2’ and specified the target host manually by entering the IP address in the field to the right of the Manual button

When we scroll down, we find the option to set credentials for authenticated checks on the target host using different services.

To specify these credentials, click on the ‘new document’ icon to enter the relevant menu. This menu also allows you to add some other configuration parameters, such as the type of authentication and credentials based on the selected authentication type. For this target host we will run authenticated checks by supplying the SSH credentials:
Username: msfadmin
Password: msfadmin

Click on the ‘Save’ button twice to return to the newly created task. In the task menu we can also specify a scan configuration that defines which checks will be performed, but for now we’ll keep the default (Full and Fast) setting

Keeping all other settings at default too, click the green ‘Save’ button. This takes us back to the ‘Tasks’ page from where we start the scan by clicking the ‘Start’ button in the ‘Actions’ column on the bottom right of the screen:

OpenVAS now runs the checks defined in the scan configuration on the target specified. Please note that the Full & Fast scan configuration can take a long time to complete, but you can always monitor progress in the meantime by clicking on the progress bar in the ‘Status’ column.

During the scan you can click through the tabs that contain results such has discovered hosts (if you’re scanning a range of targets), open ports, applications and CVEs. Depending on resources available to the virtual machine and the selected options for the scan task, such as the range of hosts and scan configuration, the scan can take a very long time to complete.
Once the scan is finished (which took about 60 minutes to) the results can be found on the results page (Top Menu: Scans -> Results).

For more detailed information about a particular vulnerability we can click on the title in the first column.

The OpenVAS scan also tested for weak credentials on services that are exposed to the network.

With OpenVAS it is also possible to export a PDF report with the scan results. You can do this by browsing to the Scans -> Reports section in the top menu. Then click the ‘Download filtered report’ button and select PDF as the report format. Click the ‘OK’ button to download the PDF report:


-- Scan configurations --

The default scan configuration (Full & Fast) which runs a lot of different checks on the target, but takes a long time to complete. To save hours of time and resources it is possible to fine-tune scans by limiting the number of checks in a custom scan configuration.
For an overview of default scan configurations select the ‘Scan Configs’ option from the ‘Configuration’ menu in the menu bar at the top. This will open a page where you will find a summary of the scan configurations available with a short description for each configuration and some statistics about the numbers of NVTs used and their families (NVT families are groups or headings of different tests that have a related purpose or target vulnerability)


-- Forgot or Lost Password --

If you forgot or lost the password for the admin account (or any other account) you can reset the password or create a new account using the following command:
sudo gvmd --user=[username] --new-password=[password]

The following command will change the password for user 'admin' to 'password':
sudo gvmd --user=admin --new-password=password





